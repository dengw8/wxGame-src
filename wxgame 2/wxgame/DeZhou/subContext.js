	define("third/subContext/es6-promise.js", function(require, module, exports){ 			
"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e,n){"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(void 0,function(){function e(e){var n=void 0===e?"undefined":t(e);return null!==e&&("object"===n||"function"===n)}function n(t){return"function"==typeof t}function r(){return void 0!==D?function(){D(i)}:o()}function o(){var t=setTimeout;return function(){return t(i,1)}}function i(){for(var t=0;t<F;t+=2)(0,G[t])(G[t+1]),G[t]=void 0,G[t+1]=void 0;F=0}function s(t,e){var n=arguments,r=this,o=new this.constructor(c);void 0===o[I]&&x(o);var i=r._state;return i?function(){var t=n[i-1];L(function(){return j(i,o,t,r._result)})}():w(r,o,t,e),o}function u(e){var n=this;if(e&&"object"==(void 0===e?"undefined":t(e))&&e.constructor===n)return e;var r=new n(c);return _(r,e),r}function c(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function a(){return new TypeError("A promises callback cannot return that same promise.")}function l(t){try{return t.then}catch(t){return V.error=t,V}}function h(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function d(t,e,n){L(function(t){var r=!1,o=h(n,e,function(n){r||(r=!0,e!==n?_(t,n):m(t,n))},function(e){r||(r=!0,b(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,b(t,o))},t)}function p(t,e){e._state===Q?m(t,e._result):e._state===R?b(t,e._result):w(e,void 0,function(e){return _(t,e)},function(e){return b(t,e)})}function v(t,e,r){e.constructor===t.constructor&&r===s&&e.constructor.resolve===u?p(t,e):r===V?(b(t,V.error),V.error=null):void 0===r?m(t,e):n(r)?d(t,e,r):m(t,e)}function _(t,n){t===n?b(t,f()):e(n)?v(t,n,l(n)):m(t,n)}function y(t){t._onerror&&t._onerror(t._result),g(t)}function m(t,e){t._state===J&&(t._result=e,t._state=Q,0!==t._subscribers.length&&L(g,t))}function b(t,e){t._state===J&&(t._state=R,t._result=e,L(y,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+Q]=n,o[i+R]=r,0===i&&t._state&&L(g,t)}function g(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?j(n,r,o,i):o(i);t._subscribers.length=0}}function A(){this.error=null}function S(t,e){try{return t(e)}catch(t){return X.error=t,X}}function j(t,e,r,o){var i=n(r),s=void 0,u=void 0,c=void 0,f=void 0;if(i){if((s=S(r,o))===X?(f=!0,u=s.error,s.error=null):c=!0,e===s)return void b(e,a())}else s=o,c=!0;e._state!==J||(i&&c?_(e,s):f?b(e,u):t===Q?m(e,s):t===R&&b(e,s))}function E(t,e){try{e(function(e){_(t,e)},function(e){b(t,e)})}catch(e){b(t,e)}}function T(){return Z++}function x(t){t[I]=Z++,t._state=void 0,t._result=void 0,t._subscribers=[]}function M(t,e){this._instanceConstructor=t,this.promise=new t(c),this.promise[I]||x(this.promise),q(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&m(this.promise,this._result))):b(this.promise,P())}function P(){return new Error("Array Methods must be provided an Array")}function C(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function k(t){this[I]=T(),this._result=this._state=void 0,this._subscribers=[],c!==t&&("function"!=typeof t&&C(),this instanceof k?E(this,t):O())}var Y=void 0,q=Y=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},F=0,D=void 0,K=void 0,L=function(t,e){G[F]=t,G[F+1]=e,2===(F+=2)&&(K?K(i):H())},N="undefined"!=typeof window?window:void 0,U=N||{},W=U.MutationObserver||U.WebKitMutationObserver,z="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),B="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,G=new Array(1e3),H=void 0;H=z?function(){return process.nextTick(i)}:W?function(){var t=0,e=new W(i),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():B?function(){var t=new MessageChannel;return t.port1.onmessage=i,function(){return t.port2.postMessage(0)}}():void 0===N&&"function"==typeof require?function(){try{var t=require("vertx");return D=t.runOnLoop||t.runOnContext,r()}catch(t){return o()}}():o();var I=Math.random().toString(36).substring(16),J=void 0,Q=1,R=2,V=new A,X=new A,Z=0;return M.prototype._enumerate=function(t){for(var e=0;this._state===J&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===u){var o=l(t);if(o===s&&t._state!==J)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===k){var i=new n(c);v(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},M.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===J&&(this._remaining--,t===R?b(r,n):this._result[e]=n),0===this._remaining&&m(r,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){return n._settledAt(Q,e,t)},function(t){return n._settledAt(R,e,t)})},k.all=function(t){return new M(this,t).promise},k.race=function(t){var e=this;return new e(q(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})},k.resolve=u,k.reject=function(t){var e=new this(c);return b(e,t),e},k._setScheduler=function(t){K=t},k._setAsap=function(t){L=t},k._asap=L,k.prototype={constructor:k,then:s,catch:function(t){return this.then(null,t)}},k.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=k},k.Promise=k,k.polyfill(),k}); 
 			});
 		define("third/subContext/ocanvas-2.8.10_wx.js", function(require, module, exports){ 			
"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))|(?:localhost))(?::\\d{2,5})?(?:/\\S*)?$","i"),i=function(){var t={},i={};return{load:function(r,s){var n=this.getRes(r);if(n)return s&&s(null,n),n;var a=t[r];if(a)return a.callbacks.push(s),a.img;n=new wx.createImage;var o=function e(){n.removeEventListener("error",e,!1);var i=t[r];if(i){for(var s=i.callbacks,a=0;a<s.length;++a){var o=s[a];o&&o("load image failed "+r)}i.img=null,delete t[r]}};return t[r]={img:n,callbacks:s?[s]:[]},n.addEventListener("load",function s(){n.removeEventListener("load",s,!1),n.removeEventListener("error",o,!1),e.test(r)||(i[r]=n);var a=t[r];if(a){for(var h=a.callbacks,c=0;c<h.length;++c){var l=h[c];l&&l(null,n)}a.img=null,delete t[r]}}),n.addEventListener("error",o),n.src=r,n},getRes:function(t){return i[t]},preload:function(t,e,i){for(var r=t.length,s=0,n=t.length;s<n;s++)this.load(t[s],function(t,s){--r<=0&&(console.error("preload finish"),e&&e.call(i))})},clearCache:function(){}}}();window.ImageLoader=i;var r={};r.p=function(t,e){return void 0===t?{x:0,y:0}:void 0===e?{x:t.x,y:t.y}:{x:t,y:e}},r.size=function(t,e){return void 0===t?{width:0,height:0}:void 0===e?{width:t.width,height:t.height}:{width:t,height:e}},r.rect=function(t,e,i,r){return void 0===t?{x:0,y:0,width:0,height:0}:void 0===e?{x:t.x,y:t.y,width:t.width,height:t.height}:{x:t,y:e,width:i,height:r}},r.color=function(t,e,i,s){return void 0===t?{r:0,g:0,b:0,a:255}:r.isString(t)?r.hexToColor(t):r.isObject(t)?{r:t.r,g:t.g,b:t.b,a:null==t.a?255:t.a}:{r:t,g:e,b:i,a:null==s?255:s}},r.pNeg=function(t){return r.p(-t.x,-t.y)},r.pAdd=function(t,e){return r.p(t.x+e.x,t.y+e.y)},r.pSub=function(t,e){return r.p(t.x-e.x,t.y-e.y)},r.pMult=function(t,e){return r.p(t.x*e,t.y*e)},r.pDot=function(t,e){return t.x*e.x+t.y*e.y},r.pLengthSQ=function(t){return r.pDot(t,t)},r.pLength=function(t){return Math.sqrt(r.pLengthSQ(t))},r.isFunction=function(t){return"function"==typeof t},r.isNumber=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},r.isString=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},r.isArray=function(e){return Array.isArray(e)||"object"===(void 0===e?"undefined":t(e))&&"[object Array]"===Object.prototype.toString.call(e)},r.isUndefined=function(t){return void 0===t},r.isObject=function(e){return"object"===(void 0===e?"undefined":t(e))&&"[object Object]"===Object.prototype.toString.call(e)},r.arrayVerifyType=function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return r.log("element type is wrong!"),!1;return!0},r.arrayRemoveObject=function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e){t.splice(i,1);break}},r.arrayRemoveArray=function(t,e){for(var i=0,s=e.length;i<s;i++)r.arrayRemoveObject(t,e[i])},r.arrayAppendObjectsToIndex=function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},r.copyArray=function(t){var e,i=t.length,r=new Array(i);for(e=0;e<i;e+=1)r[e]=t[e];return r},r.AffineTransform=function(t,e,i,r,s,n){this.a=t,this.b=e,this.c=i,this.d=r,this.tx=s,this.ty=n},r.affineTransformMake=function(t,e,i,r,s,n){return{a:t,b:e,c:i,d:r,tx:s,ty:n}},r.pointApplyAffineTransform=function(t,e,i){var r,s;return void 0===i?(i=e,r=t.x,s=t.y):(r=t,s=e),{x:i.a*r+i.c*s+i.tx,y:i.b*r+i.d*s+i.ty}},r._pointApplyAffineTransform=function(t,e,i){return r.pointApplyAffineTransform(t,e,i)},r.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},r.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},r.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},r.rectApplyAffineTransform=function(t,e){var i=r.rectGetMinY(t),s=r.rectGetMinX(t),n=r.rectGetMaxX(t),a=r.rectGetMaxY(t),o=r.pointApplyAffineTransform(s,i,e),h=r.pointApplyAffineTransform(n,i,e),c=r.pointApplyAffineTransform(s,a,e),l=r.pointApplyAffineTransform(n,a,e),d=Math.min(o.x,h.x,c.x,l.x),f=Math.max(o.x,h.x,c.x,l.x),u=Math.min(o.y,h.y,c.y,l.y),g=Math.max(o.y,h.y,c.y,l.y);return r.rect(d,u,f-d,g-u)},r._rectApplyAffineTransformIn=function(t,e){var i=r.rectGetMinY(t),s=r.rectGetMinX(t),n=r.rectGetMaxX(t),a=r.rectGetMaxY(t),o=r.pointApplyAffineTransform(s,i,e),h=r.pointApplyAffineTransform(n,i,e),c=r.pointApplyAffineTransform(s,a,e),l=r.pointApplyAffineTransform(n,a,e),d=Math.min(o.x,h.x,c.x,l.x),f=Math.max(o.x,h.x,c.x,l.x),u=Math.min(o.y,h.y,c.y,l.y),g=Math.max(o.y,h.y,c.y,l.y);return t.x=d,t.y=u,t.width=f-d,t.height=g-u,t},r.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},r.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},r.affineTransformRotate=function(t,e){var i=Math.sin(e),r=Math.cos(e);return{a:t.a*r+t.c*i,b:t.b*r+t.d*i,c:t.c*r-t.a*i,d:t.d*r-t.b*i,tx:t.tx,ty:t.ty}},r.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},r.affineTransformConcatIn=function(t,e){var i=t.a,r=t.b,s=t.c,n=t.d,a=t.tx,o=t.ty;return t.a=i*e.a+r*e.c,t.b=i*e.b+r*e.d,t.c=s*e.a+n*e.c,t.d=s*e.b+n*e.d,t.tx=a*e.a+o*e.c+e.tx,t.ty=a*e.b+o*e.d+e.ty,t},r.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},r.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}},r.POINT_EPSILON=parseFloat("1.192092896e-07F"),window.cc=r,function(e,s,n){var a=function(t){this._context=t,this._saveCount=0,this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height},o=a.prototype;o.resetCache=function(){var t=this._context;this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},o.setOffset=function(t,e){this._offsetX=t,this._offsetY=e,this._realOffsetY=this._context.canvas.height+this._offsetY},o.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},o.setViewScale=function(t,e){this._scaleX=t,this._scaleY=e},o.getContext=function(){return this._context},o.save=function(){this._context.save(),this._saveCount++},o.restore=function(){this._context.restore(),this._saveCount--},o.setGlobalAlpha=function(t){this._saveCount>0?this._context.globalAlpha=t:this._currentAlpha!==t&&(this._currentAlpha=t,this._context.globalAlpha=t)},o.setCompositeOperation=function(t){this._saveCount>0?this._context.globalCompositeOperation=t:this._currentCompositeOperation!==t&&(this._currentCompositeOperation=t,this._context.globalCompositeOperation=t)},o.setFillStyle=function(t){this._saveCount>0?this._context.fillStyle=t:this._currentFillStyle!==t&&(this._currentFillStyle=t,this._context.fillStyle=t)},o.setStrokeStyle=function(t){this._saveCount>0?this._context.strokeStyle=t:this._currentStrokeStyle!==t&&(this._currentStrokeStyle=t,this._context.strokeStyle=t)},o.setTransform=function(t,e,i){this._context.setTransform(t.a,-t.b,-t.c,t.d,this._offsetX+t.tx*e,t.ty*i)};var h={version:"2.8.10",modules:{},inits:{},plugins:{},core:function(e){this.isCore=!0,this.id=0,this.lastObjectID=0,this.children=[],this.domEventHandlers=[];for(var i in h.modules)"function"==typeof h.modules[i]?this[i]=h.modules[i]():this[i]=Object.create(h.modules[i]);if(this.settings={fps:60,background:"transparent",clearEachFrame:!0,drawEachFrame:!0,disableScrolling:!1,plugins:[]},h.extend(this.settings,e),this.originalSettings=h.extend({},this.settings),this.settings.canvas.nodeName&&"canvas"===this.settings.canvas.nodeName.toLowerCase())this.canvasElement=this.settings.canvas;else{if("string"!=typeof this.settings.canvas)return!1;this.canvasElement=s.querySelector(this.settings.canvas)}var r=this.canvasElement.width,n=this.canvasElement.height;this.canvasElement.style=this.canvasElement.style||{},this.canvas=this.canvasElement.getContext("2d"),this._renderContext=new a(this.canvas),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,set:function(t){r=isNaN(parseFloat(t))?r:parseFloat(t),this.canvasElement.width=r,this.background.set(this.settings.background),this.redraw()},get:function(){return this.canvasElement.width}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,set:function(t){n=isNaN(parseFloat(t))?n:parseFloat(t),this.canvasElement.height=n,this.background.set(this.settings.background),this.redraw()},get:function(){return this.canvasElement.height}});for(var i in h.modules){if(!0===this[i].wrapper)for(var o in this[i])"object"===t(this[i][o])&&"function"==typeof this[i][o].setCore?this[i][o]=this[i][o].setCore(this):"function"==typeof this[i][o].setCore&&this[i][o].setCore(this),this[i].core=this;this[i].core=this}for(var c in h.inits)if("string"==typeof h.inits[c]&&"function"==typeof this[c][h.inits[c]])this[c][h.inits[c]]();else if("object"===h.inits[c])for(var l in h.inits[c])"function"==typeof this[c][h.inits[c][l]]&&this[c][h.inits[c][l]]();var d=this.settings.plugins;if(d.length>0)for(var f=0,u=d.length;f<u;f++)"function"==typeof h.plugins[d[f]]&&h.plugins[d[f]].call(this)},registerModule:function(t,e,i){if(~t.indexOf(".")){var r=t.split(".");h.modules[r[0]][r[1]]=e,i!==n&&(h.inits[r[0]]||(h.inits[r[0]]={}),h.inits[r[0]][r[1]]=i)}else h.modules[t]=e,i!==n&&(h.inits[t]=i)},registerPlugin:function(t,e){h.plugins[t]=e},create:function(t){return new h.core(t)},domReady:function(t){if(t=t||function(){},this.domReadyHandlers.push(t),this.isDomReadyListening)return!1;if(this.isDomReady)return h.triggerDomReadyHandlers(),!0;var e=function t(e){("complete"===s.readyState||e&&"DOMContentLoaded"===e.type)&&(h.isDomReadyListening=!1,h.isDomReady=!0,h.triggerDomReadyHandlers(),s.removeEventListener("readystatechange",t,!1),s.removeEventListener("DOMContentLoaded",t,!1))};return!!e()||(this.isDomReadyListening?void 0:(h.isDomReadyListening=!0,s.addEventListener("readystatechange",e,!1),s.addEventListener("DOMContentLoaded",e,!1),!1))},isDomReady:!1,isDomReadyListening:!1,domReadyHandlers:[],triggerDomReadyHandlers:function(){var t,e,i,r;for(e=0,i=(t=this.domReadyHandlers).length;e<i;e++)(r=t[e])&&(delete t[e],r())}};h.core.prototype={addChild:function(t,e){return t.add(e),this},removeChild:function(t,e){return t.remove(e),this},clear:function(t){return this.draw.clear(t),this},redraw:function(){return this.draw.redraw(),this},bind:function(t,e){return this.events.bind(this.canvasElement,t.split(" "),e),this},unbind:function(t,e){return this.events.unbind(this.canvasElement,t.split(" "),e),this},trigger:function(t,e){var i=this.events;return i.triggerHandlers(this.canvasElement,t.split(" "),i.fixEventObject(e)),this},reset:function(){for(var t=this.children,e=0,i=t.length;e<i;e++)t[e].remove(),e--,i--;t.length=0,this.lastObjectID=0;var r=this.canvasElement.events;for(var s in r)r[s]instanceof Array&&this.unbind(s,r[s]);this.settings=h.extend({},this.originalSettings)},destroy:function(){this.timeline&&this.timeline.stop(),this.reset();for(var t=0,e=this.domEventHandlers.length;t<e;t++)h.removeDOMEventHandler(this,t);this.domEventHandlers.length=0,this.canvasElement=s.createElement("canvas"),this.canvas=this.canvasElement.getContext("2d")}},e.oCanvas=h,h.domReady(),h.extend=function(){var t,e,i=Array.prototype.slice.call(arguments),r=i[i.length-1],s=i.splice(0,1)[0],n=i.splice(0,1)[0],a=[];if(r.exclude&&JSON.stringify(r)===JSON.stringify({exclude:r.exclude})&&(a=r.exclude),n!==r||0===a.length)for(t in n)~a.indexOf(t)||((e=Object.getOwnPropertyDescriptor(n,t)).get||e.set?Object.defineProperty(s,t,e):s[t]=n[t]);return i.length>0?h.extend.apply(this,[s].concat(i)):s},h.addDOMEventHandler=function(t,e,i,r,s){t.domEventHandlers.push({obj:e,event:i,handler:r,useCapture:!!s}),e.addEventListener(i,r,s)},h.removeDOMEventHandler=function(t,e){var i=t.domEventHandlers[e];i.obj.removeEventListener(i.event,i.handler,i.useCapture)},h.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),"function"!=typeof Object.getPropertyDescriptor&&(Object.getPropertyDescriptor=function(t,e){for(var i=Object.getOwnPropertyDescriptor(t,e),r=Object.getPrototypeOf(t);i===n&&null!==r;)i=Object.getOwnPropertyDescriptor(r,e),r=Object.getPrototypeOf(r);return i}),e.log=function(){if(log.history=log.history||[],log.history.push(arguments),this.console){var t,e=Array.prototype.slice.call(arguments),i=e.length;for(t=0;t<i;t++)console.log(e[t])}};h.registerModule("timeline",function(){var t={init:function(){var t=this;this.core.setLoop=function(e){return t.userLoop=e,t},this.core.setRender=function(e){return t.userRender=e,t}},currentFrame:1,timeline:0,running:!1,set fps(t){this.core.settings.fps=t,this.running&&this.start()},get fps(){return this.core.settings.fps},loop:function(){if(this.running){var e=t.core;e.draw.clearScene(),"function"==typeof t.userLoop&&t.userLoop.call(e,e.canvas),e.draw.updateStatus(),e.draw.renderScene(),"function"==typeof t.userRender&&t.userRender.call(e,e.canvas),t.currentFrame++,t.timeline&&cancelAnimationFrame(t.timeline),t.timeline=requestAnimationFrame(t.loopBound)}},loopBound:function(){t.loop()},renderStep:function(){var e=t.core;e.draw.clearScene(),"function"==typeof t.userLoop&&t.userLoop.call(e,e.canvas),e.draw.updateStatus(),e.draw.renderScene(),"function"==typeof t.userRender&&t.userRender.call(e,e.canvas),t.currentFrame++},start:function(){return cancelAnimationFrame(t.timeline),t.running=!0,t.loop(),this},stop:function(){return this.running=!1,cancelAnimationFrame(t.timeline),this}};return t},"init");h.registerModule("touch",function(){return{x:0,y:0,touchState:"up",canvasFocused:!1,canvasHovered:!1,isTouch:"ontouchstart"in e||"createTouch"in s,dblTapInterval:500,init:function(){var t,e;e=(t=this.core).canvasElement,t.events.addEventTypes("touch",{move:"touchmove",enter:"touchenter",leave:"touchleave",down:"touchstart",up:"touchend",singleClick:"tap",doubleClick:"dbltap"}),this.types={touchmove:"move",touchstart:"down",touchend:"up"},this.isTouch&&(t.pointer=this,e.style.WebkitUserSelect="none",e.style.WebkitTouchCallout="none",e.style.WebkitTapHighlightColor="rgba(0,0,0,0)")},bindHandlers:function(){var t,i,r,n;t=this,r=(i=this.core).canvasElement;for(n in this.types){h.addDOMEventHandler(i,r,n,function(e){t.canvasHandler(e)},!1),h.addDOMEventHandler(i,s,n,function(e){t.docHandler(e)},!1);var a=null;try{a=e.parent.document}catch(t){}a&&h.addDOMEventHandler(i,a,n,function(e){t.docHandler(e)},!1)}this.core.settings.disableScrolling&&h.addDOMEventHandler(i,r,"touchmove",function(t){t.preventDefault()},!1)},canvasHandler:function(t,e){var i,r,s,a,o,h;if(i=this.core.events,r=this.onCanvas(t),"touchend"===t.type&&!r&&!this.canvasUpEventTriggered)return i.triggerPointerEvent(this.types.touchend,i.frontObject,"touch",t),i.triggerPointerEvent(this.types.touchend,this.core.canvasElement,"touch",t),void(this.canvasUpEventTriggered=!0);(e||r)&&(e||(this.canvasHovered=!0),"touchstart"===t.type&&(this.canvasUpEventTriggered=!1,this.canvasFocused=!0,this.touchState="down"),"touchend"===t.type&&(this.touchState="up"),s=e||!r?n:i.getFrontObject("touch"),e&&i.frontObject?(i.triggerChain(i.getParentChain(i.frontObject,!0,!0),["touchleave"]),i.frontObject=null):e?i.triggerHandlers(this.core.canvasElement,["touchleave"]):i.triggerPointerEvent(this.types[t.type],s,"touch",t),"touchstart"===t.type&&(a=(new Date).getTime(),!this.dblTapStart||a-this.dblTapStart.timestamp>this.dblTapInterval?this.dblTapStart={timestamp:a,obj:s,count:1}:this.dblTapStart.count++),"touchend"===t.type&&2===this.dblTapStart.count&&(a=(new Date).getTime(),o=s===this.dblTapStart.obj,h=a-this.dblTapStart.timestamp,o&&h<this.dblTapInterval&&i.triggerPointerEvent("doubleClick",s,"touch",t),delete this.dblTapStart))},docHandler:function(t){this.onCanvas(t)||(this.core.canvasElement.events.hasEntered?"touchmove"===t.type&&this.canvasHandler(t,!0):("touchend"===t.type&&"down"===this.touchState&&this.canvasHandler(t,!0),"touchstart"===t.type&&(this.canvasFocused=!1)))},getPos:function(t){var i,r,s=t.changedTouches;if(s!==n&&s.length>0){t=s[0];var a=this.core.canvasElement.getBoundingClientRect(),o=t.pageX-e.pageXOffset,h=t.pageY-e.pageYOffset;i=1*(o-Math.round(a.left)),r=1*(h-Math.round(a.top))}else i=this.x,r=this.y;return{x:i,y:r}},updatePos:function(t){var e=this.getPos(t);this.x=e.x,this.y=e.y},onCanvas:function(t){var e=(t=t||this.core.events.lastPointerEventObject&&this.core.events.lastPointerEventObject.originalEvent)?this.getPos(t):{x:this.x,y:this.y};return e.x>=0&&e.x<=this.core.width&&e.y>=0&&e.y<=this.core.height?(this.canvasHovered=!0,t&&this.updatePos(t),!0):(this.canvasHovered=!1,!1)},cancel:function(){this.core.events.lastDownObject=null}}},"init");h.registerModule("tools",function(){return{transformPointerPosition:function(e,i,r,s,n){if(s=s||0,n=n||this.core.pointer,"object"===(void 0===e?"undefined":t(e))){var a,o,h,c,l,d=e.parent,f=[],u={x:0,y:0};for(f.push(e);d&&d!==this.core;)f.push(d),d=d.parent;for(f.reverse(),a=n,h=0,c=f.length;h<c;h++)o=f[h],a=u=this.transformPointerPosition(o.rotation,o.abs_x,o.abs_y,0,a);return 0!==s&&(l=e.getOrigin(),u=this.transformPointerPosition(-1*s,i-l.x,r-l.y,0,a)),{x:u.x,y:u.y}}var g,y,p,_=e,v=n.x>=i&&n.y<=r,x=n.x>=i&&n.y>=r,b=n.x<=i&&n.y>=r,m=n.x<=i&&n.y<=r,w=Math.sqrt(Math.pow(n.x-i,2)+Math.pow(n.y-r,2)),_=360*(_/360-Math.floor(_/360))-s,C=0===w?0:Math.abs(n.y-r)/w;return v||b?(g=(180-_-180*Math.asin(C)/Math.PI)*Math.PI/180,y=i+Math.cos(g)*w*(v?-1:1),p=r+Math.sin(g)*w*(v?-1:1)):(m||x)&&(g=(180*Math.asin(C)/Math.PI-_)*Math.PI/180,y=i+Math.cos(g)*w*(m?-1:1),p=r+Math.sin(g)*w*(m?-1:1)),{x:y,y:p}},isPointerInside:function(t,e){if(U=t.getOrigin(),"line"===t.type){var i=Math.abs(t._.end_x-t.abs_x),r=Math.abs(t._.end_y-t.abs_y),s=Math.sqrt(i*i+r*r),n=t.start,a=t.end,o=n.x<a.x&&n.y<a.y||n.x>a.x&&n.y>a.y?-1:1,h=Math.asin(r/s)*(180/Math.PI)*o;return(y=this.transformPointerPosition(t,t.abs_x,t.abs_y,h,e)).x>t.abs_x-s-U.x&&y.x<t.abs_x+s-U.x&&y.y>t.abs_y-t.strokeWidth/2-U.y&&y.y<t.abs_y+t.strokeWidth/2-U.y}if("text"===t.type){var c,l,d,f,u,g,y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),p=t.strokeWidth/2,_=t._.lines,v=_.length,x=t.size*t.lineHeight,b=t.align,m="rtl"===this.core.canvasElement.dir;for(c={top:.05*t.size,hanging:-.12*t.size,middle:-.47*t.size,alphabetic:-.78*t.size,ideographic:-.83*t.size,bottom:-1*t.size},O=0;O<v;O++)if(l={start:m?t.width-_[O].width:0,left:0,center:(t.width-_[O].width)/2,end:m?0:t.width-_[O].width,right:t.width-_[O].width},d=t.abs_x+l[b],f=d+_[O].width,u=t.abs_y+x*O+c[t.baseline],g=u+x+(v>0&&O<v-1?1:0),y.x>d-U.x-p&&y.x<f-U.x+p&&y.y>u-U.y-p&&y.y<g-U.y+p)return!0;return!1}if("rectangular"===t.shapeType){var y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),p="outside"===t.strokePosition?t.strokeWidth:"center"===t.strokePosition?t.strokeWidth/2:0;return y.x>t.abs_x-U.x-p&&y.x<t.abs_x+t.width-U.x+p&&y.y>t.abs_y-U.y-p&&y.y<t.abs_y+t.height-U.y+p}if("ellipse"===t.type&&t.radius_x===t.radius_y)return y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),(s=Math.sqrt(Math.pow(y.x-t.abs_x+U.x,2)+Math.pow(y.y-t.abs_y+U.y,2)))<t.radius_x+t.strokeWidth/2;if("ellipse"===t.type){var y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),w=t.radius_x+t.strokeWidth/2,C=t.radius_y+t.strokeWidth/2;return y.x-=t.abs_x-U.x,y.y-=t.abs_y-U.y,y.x*y.x/(w*w)+y.y*y.y/(C*C)<1}if("polygon"===t.type){var O,D,M,y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),P=t.radius+t.strokeWidth/2,T=t.sides,F=T-1,k=!1;for(O=0;O<T;O++)D={x:t.abs_x-U.x+P*Math.cos(2*O*Math.PI/T),y:t.abs_y-U.y+P*Math.sin(2*O*Math.PI/T)},M={x:t.abs_x-U.x+P*Math.cos(2*F*Math.PI/T),y:t.abs_y-U.y+P*Math.sin(2*F*Math.PI/T)},(D.y<y.y&&M.y>=y.y||M.y<y.y&&D.y>=y.y)&&D.x+(y.y-D.y)/(M.y-D.y)*(M.x-D.x)<y.x&&(k=!k),F=O;return k}if("arc"===t.type){var S,E,j=t.end-t.start,N="clockwise"===t.direction?(j<0?360:0)+(j%360?j%360:j>0?360:0):Math.abs(j),I="clockwise"===t.direction?-1*t.start:-1*t.end,y=this.transformPointerPosition(t,t.abs_x,t.abs_y,I,e),s=Math.sqrt(Math.pow(y.x-t.abs_x+U.x,2)+Math.pow(y.y-t.abs_y+U.y,2)),P=t.radius,H={},A={};if(0===t.strokeWidth&&s>P||t.strokeWidth>0&&s>P+t.strokeWidth/2)return!1;if(P===t.strokeWidth/2||t.pieSection){var R=t.pieSection?t.radius:R;if(N>180)return W=Math.abs(t.abs_x-U.x-y.x),L=Math.abs(t.abs_y-U.y-y.y),z=Math.sqrt(W*W+L*L),Y=180*Math.acos(W/z)/Math.PI,y.y>=t.abs_y-U.y&&s<=R||y.y<t.abs_y-U.y&&y.x<t.abs_x-U.x&&Y<=N-180;if(180===N)return y.y>=t.abs_y-U.y&&s<=R;if(N<180){I=90-N/2-("clockwise"===t.direction?t.start:t.end),y=this.transformPointerPosition(t,t.abs_x,t.abs_y,I,e);var W,L,z,Y;return P*=2,q=Math.cos(N/2*Math.PI/180)*P,W=Math.abs(t.abs_x-U.x-y.x),L=Math.abs(t.abs_y-U.y-y.y),z=Math.sqrt(W*W+L*L),Y=180*Math.asin(W/z)/Math.PI,y.y>=t.abs_y-U.y+q||y.y>=t.abs_y-U.y&&Y<=N/2}}else{if(N>180){w=(360-N)/2,S=Math.cos(w*Math.PI/180)*P,H.x=t.abs_x-U.x+Math.cos(w*Math.PI/180)*S,H.y=t.abs_y-U.y-Math.sin(w*Math.PI/180)*S,E=180-2*w,A.x=t.abs_x-U.x-Math.cos(E*Math.PI/180)*P,A.y=t.abs_y-U.y-Math.sin(E*Math.PI/180)*P;var X=90-(90-E)-(90-w);if(y.y<H.y&&y.x<H.x)h=w-180*Math.acos(Math.abs(y.y-H.y)/Math.sqrt(Math.pow(y.x-H.x,2)+Math.pow(y.y-H.y,2)))/Math.PI;else if(y.y>H.y&&y.x>=H.x)h=X-180*Math.acos(Math.abs(y.x-H.x)/Math.sqrt(Math.pow(y.x-H.x,2)+Math.pow(y.y-H.y,2)))/Math.PI;else{if(y.y<t.abs_y-U.y&&y.x>=H.x)return!1;h=-1e6}return!((""===t.fill||"transparent"===t.fill)&&t.strokeWidth>0&&s<P-t.strokeWidth/2)&&(h<=0&&y.x>=A.x&&y.y>H.y&&y.y<t.abs_y-U.y||h<=0&&y.y<=t.abs_y-U.y&&s<=P||(0===t.strokeWidth&&s<=P||t.strokeWidth>0&&s<=P+t.strokeWidth/2)&&(y.x<=A.x&&y.y<=t.abs_y-U.y||y.y>=t.abs_y-U.y))}if(180===N)return y.y>=t.abs_y-U.y&&(0===t.strokeWidth&&s<=P||t.strokeWidth>0&&s<=P+t.strokeWidth/2);if(N<180){I=90-N/2-("clockwise"===t.direction?t.start:t.end),y=this.transformPointerPosition(t,t.abs_x,t.abs_y,I,e);var G,q;return G=""===t.fill?P-t.strokeWidth/2:P,q=Math.cos(N/2*Math.PI/180)*G,""===t.fill&&t.strokeWidth>0?y.y>=t.abs_y-U.y+q&&s>=P-t.strokeWidth/2&&s<=P+t.strokeWidth/2:y.y>=t.abs_y-U.y+q&&(!(t.strokeWidth>0)||s<=P+t.strokeWidth/2)}}}else if("radial"===t.shapeType&&(P=t.radius?t.radius:0)>0){var y=this.transformPointerPosition(t,t.abs_x,t.abs_y,0,e),U=t.getOrigin();return(s=Math.sqrt(Math.pow(y.x-t.abs_x+U.x,2)+Math.pow(y.y-t.abs_y+U.y,2)))<P}}}});h.registerModule("events",function(){return{enabled:!0,eventTypes:{},init:function(){this.core.canvasElement.events={}},addEventTypes:function(t,e){this.eventTypes[t]=this.eventTypes[t]||[];var i=this.eventTypes[t];for(var r in e)i[r]=i[r]||[],i[r].push(e[r])},bind:function(t,e,i){for(var r=0;r<e.length;r++)t.events[e[r]]=t.events[e[r]]||[],t.events[e[r]].push(i)},unbind:function(t,e,i){var r,s,a;for(r=0;r<e.length;r++)(s=t.events[e[r]])!==n&&(i===n?delete t.events[e[r]]:~(a=s.indexOf(i))&&s.splice(a,1))},findFrontObject:function(t,e){var i,r,s;if(0===t.length)return!1;for(i=t.length;i--&&(r=t[i],!1===(s=this.findFrontObject(r.children,e)));)if(r.pointerEvents&&r.isPointerInside(e)){s=r;break}return s},getFrontObject:function(t){return this.findFrontObject(this.core.children,this.core[t])||n},triggerPointerEvent:function(t,e,i,r){if(this.enabled){var s,n,a,o,h,c,l,d,f,u,g;if(s=this.core.canvasElement,n=this.eventTypes[i],a=n.enter,o=n.leave,h=n[t],c=n.singleClick,this.lastPointerEventObject=this.fixEventObject(r,i),e){if(e!==this.frontObject){if(this.frontObject&&!~(l=this.getParentChain(e)).indexOf(this.frontObject))if(this.triggerHandlers(this.frontObject,o),~(l=this.getParentChain(this.frontObject)).indexOf(e)){for(d=[],u=0,g=l.length;u<g&&l[u]!==e;u++)d.push(l[u]);this.triggerChain(d,o)}else this.triggerChain(l,o);this.frontObject=e,(e.parent||s).events.hasEntered||(l=this.findNonEnteredParentChain(e),this.triggerChain(l,a)),e.events.hasEntered||this.triggerHandlers(e,a)}}else this.frontObject?(d=this.getParentChain(this.frontObject,!1,!0),this.triggerChain(d,o),this.frontObject=null):s.events.hasEntered||this.triggerHandlers(s,a),e=this.core.canvasElement;"down"===t&&(this.lastDownObject=e),d=this.getParentChain(e,!0,!0),this.triggerChain(d,h),"up"===t&&(e===this.lastDownObject?this.triggerChain(d,c):(f=this.getSharedParent(e,this.lastDownObject))&&(d=this.getParentChain(f,!0,!0),this.triggerChain(d,c)),this.lastDownObject=null)}},getSharedParent:function(t,e){var i,r,s;for(i=this.getParentChain(t,!0,!0),r=this.core.canvasElement,s=e;s&&!~i.indexOf(s);)s=s.parent||(s!==r?r:n);return s},findNonEnteredParentChain:function(t){var e,i,r;for(e=[],i=this.core.canvasElement,r=t.parent;r&&!r.events.hasEntered;)e.push(r),r=r.parent;return r||i.events.hasEntered||e.push(i),e.reverse()},getParentChain:function(t,e,i){var r,s;for(r=[],i&&r.push(t),s=t.parent;s;)r.push(s),s=s.parent;return e&&t!==this.core.canvasElement&&r.push(this.core.canvasElement),r},triggerChain:function(t,e,i){var r,s;for(r=0,s=t.length;r<s&&this.triggerHandlers(t[r],e,i);r++);},triggerHandlers:function(t,e,i){var r,s,n,a,o,h,c,l=t===this.core.canvasElement?this.core:t;for(r=0;r<e.length;r++)if(s=t.events[e[r]],n=!!~e[r].indexOf("enter"),a=!!~e[r].indexOf("leave"),c=i||(~e[r].indexOf("key")?this.lastKeyboardEventObject:this.lastPointerEventObject),c.type=e[r],c.bubbles=!n&&!a,n&&!t.events.hasEntered?t.events.hasEntered=!0:a&&t.events.hasEntered&&(t.events.hasEntered=!1),s){for(o=s.length,h=0;h<o;h++)"function"==typeof s[h]&&s[h].call(l,c);if(c.stoppingPropagation)return c.stoppingPropagation=!1,!1}return!0},fixEventObject:function(t,e){var i,r,s,a,o="altKey ctrlKey metaKey shiftKey button charCode keyCode clientX clientY pageX pageY screenX screenY detail eventPhase isChar touches targetTouches changedTouches scale rotation".split(" "),h=o.length;if(i={originalEvent:t,timeStamp:(new Date).getTime(),which:t===n?0:0===t.which?t.keyCode:t.which,preventDefault:function(){t!==n&&t.preventDefault()},stopPropagation:function(){this.bubbles&&(this.stoppingPropagation=!0),t!==n&&t.stopPropagation()}},t===n)return i;for(r=0;r<h;r++)s=o[r],t[s]!==n&&(i[s]=t[s]);return~"mouse touch".indexOf(e)&&(i.x=this.core[e].x,i.y=this.core[e].y),"mouse"===e&&(a={0:1,2:2,1:3,default:0},i.which=a[i.button]||a.default),"touch"===e&&(i.which=0),i}}},"init");h.registerModule("draw",function(){return{drawcalls:0,objects:[],translation:{x:0,y:0},_nextDeltaTimeZero:!1,_deltaTime:0,_totalFrames:0,_lastUpdate:null,childrenOrderDirty:!0,_curLevel:-1,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:r.color(255,255,255,1),_clearFillStyle:"rgb(255, 255, 255)",_lastProfileTime:0,_retina:!0,_devicePixelRatio:2,init:function(){this._lastUpdate=Date.now()},isRetinaEnabled:function(){return this._retina},getPixelRatio:function(){return this._devicePixelRatio},visit:function(){var t=this.core.children,e=t.length;if(0!=e)for(var i=0;i<e;i++)t[i].visit()},calculateDeltaTime:function(){var t=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(t-this._lastUpdate)/1e3,this._deltaTime>.2&&(this._deltaTime=1/60),this._lastUpdate=t},updateStatus:function(){!0===this.childrenOrderDirty?(this.clearRenderCommands(),this.assignedZ=0,this._curLevel=0,this.visit(),this.resetFlag()):!0===this.transformDirty()&&this.transform()},getContentScalor:function(){return 1},renderScene:function(t,e,i){var s,n,a=this._renderCmds,o=t||this.core._renderContext;o.computeRealOffsetY();var h=this.getContentScalor();for(e=r.isUndefined(e)?h:e,i=r.isUndefined(i)?h:i,s=0,n=a.length;s<n;s++)a[s].isInViewRect()&&a[s].rendering(o,e,i)},_renderingToCacheCanvas:function(t,e,i,s){t||r.log("The context of RenderTexture is invalid."),i=r.isUndefined(i)?1:i,s=r.isUndefined(s)?1:s,e=e||this._currentID;var n,a,o=this._cacheToCanvasCmds[e];for(t.computeRealOffsetY(),t.save(),n=0,a=o.length;n<a;n++)o[n].visible&&o[n].rendering(t,i,s);this._removeCache(e),t.restore();var h=this._cacheInstanceIds;0===h.length?this._isCacheToCanvasOn=!1:this._currentID=h[h.length-1]},_turnToCacheMode:function(t){this._isCacheToCanvasOn=!0,t=t||0,this._cacheToCanvasCmds[t]=[],-1===this._cacheInstanceIds.indexOf(t)&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToCanvasCmds[t];e&&(e.length=0,delete this._cacheToCanvasCmds[t]);var i=this._cacheInstanceIds;r.arrayRemoveObject(i,t)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);for(var e=0,i=t.length;e<i;e++)0!==t[e]._dirtyFlag&&t[e].updateStatus();t.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clearScene:function(){var t=this.core._renderContext,e=t.getContext();e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this.core.width,this.core.height),0===this._clearColor.r&&0===this._clearColor.g&&0===this._clearColor.b||(t.setFillStyle(this._clearFillStyle),t.setGlobalAlpha(this._clearColor.a),e.fillRect(0,0,this.core.width,this.core.height)),this.drawcalls=0},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1},pushRenderCommand:function(t){if(t.needDraw())if(this._isCacheToCanvasOn){var e=this._currentID,i=this._cacheToCanvasCmds[e];-1===i.indexOf(t)&&i.push(t)}else-1===this._renderCmds.indexOf(t)&&this._renderCmds.push(t)},changeZorder:function(t,e,i){var r,s,a,o=t.children,h=o[e];o[i],h!==n&&e!==i&&(i>o.length-1&&(i=o.length-1),i<0&&(i=0),i>e?(r=o.slice(0,e),a=o.slice(i+1,o.length),(s=o.slice(e,i+1)).shift(),s.push(h)):(r=o.slice(0,i),a=o.slice(e+1,o.length),(s=o.slice(i,e+1)).pop(),s.unshift(h)),t.children=r.concat(s).concat(a))},clear:function(t){return this.core.canvas.clearRect(0,0,this.core.width,this.core.height),!1!==t&&this.core.background.redraw(),this.isCleared=!0,this.drawcalls=0,this},redraw:function(t){}}},"init");h.registerModule("background",function(){return{bg:"",value:"",type:"transparent",loaded:!1,init:function(){this.set(this.core.settings.background)},set:function(t){var e=this;if("string"!=typeof t&&(t=""),this.value=t,~t.indexOf("gradient")?this.type="gradient":~t.indexOf("image")?this.type="image":this.core.style&&this.core.style.isColor(t)?this.type="color":this.type="transparent","color"===this.type)this.bg=t,this.core.timeline&&!this.core.timeline.running&&this.core.draw.redraw(!0),this.loaded=!0;else if("gradient"===this.type)this.bg=this.core.style?this.core.style.getGradient(t,0,0,this.core.width,this.core.height):"",this.core.timeline&&!this.core.timeline.running&&this.core.draw.redraw(!0),this.loaded=!0;else if("image"===this.type){var i=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(t),r=i[1],s=i[4]||"repeat",n=new Image;n.src=r,n.onload=function(){e.bg=e.core.canvas.createPattern(this,s),e.loaded=!0,e.core.timeline&&!e.core.timeline.running&&e.core.redraw(!0)}}else this.redraw(!0),this.loaded=!0;return this},redraw:function(){var t=this.core;"transparent"!==this.type&&(t.canvas.fillStyle=this.bg,t.canvas.fillRect(0,0,t.width,t.height))}}},"init");h.registerModule("style",function(){return{getStroke:function(e,i){if(i="string"===i?"string":"object","object"===(void 0===e?"undefined":t(e))&&"string"===i){var r=e;e="string"==typeof r.pos?r.pos:"center",e+=" "+("number"==typeof r.width?r.width+"px":"1px"),e+=" "+("string"==typeof r.color?r.color:"#000000")}for(var s,a,o=e.split(" "),h=0,c=o.length;h<c;h++)!s&&o[h].indexOf("(")>-1&&(s=h),o[h].indexOf(")")>-1&&(a=h);(l=a?o.splice(s,a-s+1):n)&&o.push(l.join(" "));var l,d,f=["outside","center","inside"],u="",g=o.length;if(g>=3)if(~f.indexOf(o[0])){if(g>3){for(h=2;h<g;h++)u+=o[h]+(h===g-1?" ":"");o=[o[0],o[1],u]}o={pos:o[0],width:parseFloat(o[1]),color:o[2]}}else{for(h=(d=isNaN(parseInt(o[0])))?0:1;h<g;h++)u+=o[h]+(h===g-1?" ":"");o=d?[1,u]:[o[0],u],g=2}return 2===g&&(o={pos:"center",width:parseFloat(o[0]),color:o[1]}),o.length&&(o={pos:"center",width:0,color:""}),"string"===i?o.pos+" "+o.width+"px "+o.color:"object"===i?o:void 0},getGradient:function(t,e,i,r,s){return~t.indexOf("linear")?this.getLinearGradient(t,e,i,r,s):~t.indexOf("radial")?this.getRadialGradient(t,e,i,r,s):"transparent"},getLinearGradient:function(t,e,i,r,s){var n,a,o,h,c,l,d,f,u,g,y,p,_=[],v=["top","bottom","left","right"],x=[];for(a=/\((.*)\)/.exec(t)[1];u=/((hsl|hsla|rgb|rgba)\(.*?\))/.exec(a);)g=x.push(u[1])-1,a=a.substring(0,u.index)+"###"+g+"###"+a.substring(u.index+u[1].length,a.length);if(a=a.split(","),o=a[0].split(" "),(~v.indexOf(o[0])||~o[0].indexOf("deg"))&&_.push(o[0]),o.length>1&&~v.indexOf(o[1])&&_.push(o[1]),0===_.length?_.push("top"):h=1,1===_.length){if("top"===_[0])c=e+r/2,l=i,d=e+r/2,f=i+s;else if("right"===_[0])c=e+r,l=i+s/2,d=e,f=i+s/2;else if("bottom"===_[0])c=e+r/2,l=i+s,d=e+r/2,f=i;else if("left"===_[0])c=e,l=i+s/2,d=e+r,f=i+s/2;else if(~_[0].indexOf("deg")){var b,m,w,C,O,D,M,P=Math.PI,T=e+r/2,F=i+s/2;m=b=parseFloat(_)%360*P/180,b>=0&&b<P/2?(O=e+r,D=i):b>=P/2&&b<P?(M=F,F=T,D=e,O=M,T=i):b>=P&&b<1.5*P?(M=F,O=T,T=e,F=i+s,D=M):b>=1.5*P&&b<2*P&&(M=F,F=e+r,D=T,O=i+s,T=M),b%=P/2,w=Math.atan(Math.abs(F-D)/Math.abs(O-T)),C=Math.sqrt(Math.pow(F-D,2)+Math.pow(T-O,2))*Math.cos(w-b),m>=0&&m<P/2?(c=2*T-(d=T+C*Math.cos(b)),l=2*F-(f=F-C*Math.sin(b))):m>=P/2&&m<P?(c=2*F-(d=F-C*Math.cos(P/2-b)),l=2*O-(f=O-C*Math.sin(P/2-b))):m>=P&&m<1.5*P?(c=2*O-(d=O+C*Math.cos(P-b)),l=2*D-(f=D+C*Math.sin(P-b))):m>=1.5*P&&m<2*P&&(c=2*D-(d=D-C*Math.cos(1.5*P-b)),l=2*T-(f=T-C*Math.sin(1.5*P-b)))}}else~_.indexOf("top")&&~_.indexOf("left")?(c=e,l=i,d=e+r,f=i+s):~_.indexOf("top")&&~_.indexOf("right")?(c=e+r,l=i,d=e,f=i+s):~_.indexOf("bottom")&&~_.indexOf("left")?(c=e,l=i+s,d=e+r,f=i):~_.indexOf("bottom")&&~_.indexOf("right")&&(c=e+r,l=i+s,d=e,f=i);for(n=this.core.canvas.createLinearGradient(c,l,d,f),y=this.getColorStops(n,a.slice(h),x),p=0;p<y.length;p++)n.addColorStop(y[p].pos/100,y[p].color);return n},getRadialGradient:function(t,e,i,r,s){var a,o,h,c,l,d,f,u,g,y,p,_=["left","center","right"],v=["top","center","bottom"],x={left:e,center:e+r/2,right:e+r},b={top:i,center:i+s/2,bottom:i+s},m=["closest-side","closest-corner","farthest-side","farthest-corner","contain","cover"],w=[],C=0,O=[{x:n,y:n,r:0},{x:n,y:n,r:n}],D=!1;for(o=/\((.*)\)/.exec(t)[1];c=/((hsl|hsla|rgb|rgba)\(.*?\))/.exec(o);)l=w.push(c[1])-1,o=o.substring(0,c.index)+"###"+l+"###"+o.substring(c.index+c[1].length,o.length);for((o=o.split(/\s*,\s*/)).length,h=0;h<2;h++)~o[h].indexOf(" ")?("center"===(u=o[h].split(" "))[0]?(O[h].x=u[0],O[h].y=u[1],C=h+1):~_.indexOf(u[0])?(O[h].x=u[0],C=h+1,~v.indexOf(u[1])&&(O[h].y=u[1])):~v.indexOf(u[0])?(O[h].y=u[0],C=h+1,~_.indexOf(u[1])&&(O[h].x=u[1])):isNaN(parseFloat(u[0]))||(O[h].x=u[0],C=h+1,!~v.indexOf(u[1])&&isNaN(parseFloat(u[1]))||(O[h].y=u[1])),O[h].x||(O[h].x="center"),O[h].y||(O[h].y="center")):(~_.indexOf(o[h])?(O[h].x=o[h],C=h+1):~v.indexOf(o[h])?(O[h].y=o[h],C=h+1):O[h].x=1===h?O[0].x:"center",O[h].y=1===h?O[0].y:"center");for(~m.indexOf(o[C])&&(p=o[C],D=!0),/\d+(%|px)\s/.test(o[C])&&(p=parseFloat(o[C]),D=!0,isNaN(p)&&(p=0)),p===n&&(p="cover"),h=0;h<2;h++)for(O[h].abs_x=x[O[h].x],O[h].abs_y=b[O[h].y],g=0;g<2;g++)y="abs_"+(0===g?"x":"y"),O[h][y]===n&&(O[h][y]=parseFloat(O[h]["abs_x"===y?"x":"y"]),isNaN(O[h][y])&&(O[h][y]="abs_x"===y?x.center-e:b.center-i),~O[h]["abs_x"===y?"x":"y"].indexOf("%")&&(O[h][y]=O[h][y]/100*("abs_x"===y?r:s)),O[h][y]+="abs_x"===y?e:i);for(~m.indexOf(p)&&(p="closest-side"===p||"contain"===p?Math.min(Math.abs(O[1].abs_y-i),Math.abs(i+s-O[1].abs_y),Math.abs(O[1].abs_x-e),Math.abs(e+r-O[1].abs_y)):"closest-corner"===p?Math.min(Math.sqrt(Math.pow(O[1].abs_x-e,2)+Math.pow(O[1].abs_y-i,2)),Math.sqrt(Math.pow(e+r-O[1].abs_x,2)+Math.pow(O[1].abs_y-i,2)),Math.sqrt(Math.pow(e+r-O[1].abs_x,2)+Math.pow(i+s-O[1].abs_y,2)),Math.sqrt(Math.pow(O[1].abs_x-e,2)+Math.pow(i+s-O[1].abs_y,2))):"farthest-corner"===p||"cover"===p?Math.max(Math.sqrt(Math.pow(O[1].abs_x-e,2)+Math.pow(O[1].abs_y-i,2)),Math.sqrt(Math.pow(e+r-O[1].abs_x,2)+Math.pow(O[1].abs_y-i,2)),Math.sqrt(Math.pow(e+r-O[1].abs_x,2)+Math.pow(i+s-O[1].abs_y,2)),Math.sqrt(Math.pow(O[1].abs_x-e,2)+Math.pow(i+s-O[1].abs_y,2))):"farthest-side"===p?Math.max(Math.abs(O[1].abs_y-i),Math.abs(i+s-O[1].abs_y),Math.abs(O[1].abs_x-e),Math.abs(e+r-O[1].abs_y)):0),~o[C].indexOf("%")&&(p=p/100*(~o[C].indexOf(" ")&&"height"===o[C].split(" ")[1]?s:r)),O[1].r=p,a=this.core.canvas.createRadialGradient(O[0].abs_x,O[0].abs_y,O[0].r,O[1].abs_x,O[1].abs_y,O[1].r),d=this.getColorStops(a,o.slice(C+(D?1:0)),w),f=0;f<d.length;f++)a.addColorStop(d[f].pos/100,d[f].color);return a},getColorStops:function(t,e,i){var r,s,a,o,h,c=e.length,l=[];for(r=0;r<c&&(s=e[r].trim(),!(h>=100));r++)~s.indexOf(" ")?(o=(a=s.split(" "))[0],h=~(h=a[1]).indexOf("px")?parseFloat(h)/Math.sqrt(Math.pow(eX-sX,2)+Math.pow(eY-sY,2))*100:parseFloat(h)):(o=s,h===n?h=0:(h=h||0,h+=(100-h)/(c-r))),~o.indexOf("###")&&(o=i[/###(\d+)###/.exec(o)[1]]),l.push({pos:h,color:o});return l},getFont:function(e,i){if(i="string"===i?"string":"object","object"===(void 0===e?"undefined":t(e))&&"string"===i){var r=e;e="string"==typeof r.style?r.style:"normal",e+=" "+("string"==typeof r.variant?r.variant:"normal"),e+=" "+("string"==typeof r.weight?r.weight:"normal"),e+=" "+("number"==typeof r.size?~~(10*r.size+.5)/10+"px":"16px"),e+="/"+("number"==typeof r.lineHeight?~~(10*r.lineHeight+.5)/10:"string"==typeof r.lineHeight&&r.lineHeight.indexOf("px")>-1?r.lineHeight:1),e+=" "+("string"==typeof r.family?r.family:"sans-serif")}if(e.length>0){var s,e,a,o,h=e.split(" "),c=h.length,l="",d=["normal","italic","oblique"],f=["normal","small-caps"],u=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],g={};for(s=0;s<c;s++)if(e=h[s],~d.indexOf(e)&&!g.style)g.style=e;else if(~f.indexOf(e)&&!g.variant)g.variant=e;else if(~u.indexOf(e)&&!g.weight)g.weight=e;else if(!~e.indexOf("/")||g.size||g.lineHeight){if(!g.size&&/\d+[a-z]{2}(?!\/)/.test(e))isNaN(parseInt(e))||(g.size=parseInt(e));else if(isNaN(parseInt(e))&&!g.family){for(l="",o=s;o<c;o++)l+=h[o]+(o===c-1?"":" ");g.family=l}}else a=e.split("/"),isNaN(parseInt(a[0]))||(g.size=parseInt(a[0])),isNaN(parseFloat(a[1]))||(g.lineHeight=parseFloat(a[1]),g.lineHeightUnit=a[1].indexOf("px")>-1?"px":"relative")}return h=g||{},h.style=h.style?h.style:"normal",h.variant=h.variant?h.variant:"normal",h.weight=h.weight?h.weight:"normal",h.size=h.size!==n?h.size:16,h.lineHeight=h.lineHeight!==n?h.lineHeight:1,h.lineHeightUnit=h.lineHeightUnit!==n?h.lineHeightUnit:"relative",h.family=h.family?h.family:"sans-serif","string"===i?h.style+" "+h.variant+" "+h.weight+" "+h.size+"px/"+h.lineHeight+("px"===h.lineHeightUnit?"px":"")+" "+h.family:"object"===i?h:void 0},getShadow:function(e,i){var r={};if("object"===(void 0===e?"undefined":t(e)))r.offsetX=isNaN(parseFloat(e.offsetX))?0:parseFloat(e.offsetX),r.offsetY=isNaN(parseFloat(e.offsetY))?0:parseFloat(e.offsetY),r.blur=isNaN(parseFloat(e.blur))?0:parseFloat(e.blur),r.color=this.isColor(e.color)?e.color:"#000";else if("string"==typeof e){var s=/^(.*?)\s(.*?)\s(.*?)\s(.*?)$/.exec(e);r.offsetX=isNaN(parseFloat(s[1]))?0:parseFloat(s[1]),r.offsetY=isNaN(parseFloat(s[2]))?0:parseFloat(s[2]),r.blur=isNaN(parseFloat(s[3]))?0:parseFloat(s[3]),r.color=this.isColor(s[4])?s[4]:"#000"}return"string"===i?r.offsetX+"px "+r.offsetY+"px "+r.blur+"px "+r.color:r},isColor:function(t){return"string"==typeof t&&("#"===t[0]||"rgb("===t.substr(0,4)||"rgba("===t.substr(0,5)||"hsl("===t.substr(0,4)||"hsla("===t.substr(0,5))}}}),e.logs=[];var c=function(){var t=function(t,e,i,r,s){var n=s.style.getStroke(t.stroke);n[e]=i,t.stroke=s.style.getStroke(n,"string")};return{_dirtyFlags:{transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,all:511},_dirtyFlag:1,_savedDirtyFlag:!0,_needDraw:!0,_transform:{a:1,b:0,c:0,d:1,tx:0,ty:0},_worldTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},_inverse:{a:1,b:0,c:0,d:1,tx:0,ty:0},_displayedColor:r.color(255,255,255),_inViewRect:!0,_visible:!0,id:0,shapeType:"rectangular",type:"",origin:{x:0,y:0},org_x:0,org_y:0,events:{},children:[],added:!1,opacity:1,rotation:0,composition:"source-over",scalingX:1,scalingY:1,pointerEvents:!0,animationQueues:{},show:!1,textureDirty:!1,originDirty:!0,_cacheCanvas:null,useRenderCache:!1,_:{x:0,y:0,abs_x:0,abs_y:0,rotation:0,width:0,height:0,drawn:!1,stroke:"",strokeColor:"",strokeWidth:0,strokePosition:"center",cap:"butt",join:"miter",miterLimit:10,fill:"",shadow:{offsetX:0,offsetY:0,blur:0,color:"transparent"}},set mustShow(t){this.show=t},set strokeColor(e){t(this,"color",e,"strokeColor",this.core),this.textureDirty=!0},set strokeWidth(e){t(this,"width",e,"strokeWidth",this.core),this.textureDirty=!0},set strokePosition(e){t(this,"pos",e,"strokePosition",this.core),this.textureDirty=!0},set stroke(t){"string"!=typeof t&&(t=this.core.style.getStroke(t,"string"));var e=this.core.style.getStroke(t);if(~e.color.indexOf("image(")){var i=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(e.color),r=i[1],s=i[4]||"repeat",n=new Image,a=this;n.src=r,this._.strokepattern_loading=!0,this._.strokepattern_redraw=!1,n.onload=function(){a._.strokeColor=a.core.canvas.createPattern(this,s),a._.strokepattern_loading=!1,a._.strokepattern_redraw&&(a._.strokepattern_redraw=!1,a.redraw())}}else this._.strokeColor=e.color;this._.strokeWidth=e.width,this._.strokePosition=e.pos,this._.stroke=t,this.textureDirty=!0},set cap(t){var e=["butt","round","square"];this._.cap=~e.indexOf(t)?t:"butt",this.textureDirty=!0},set join(t){var e=["round","bevel","miter"];this._.join=~e.indexOf(t)?t:"miter",this.textureDirty=!0},set miterLimit(t){this._.miterLimit=isNaN(parseFloat(t))?10:parseFloat(t),this.textureDirty=!0},get mustShow(){return this.show},get stroke(){return this._.stroke},get strokeColor(){if(this._.strokepattern_loading)return this._.strokepattern_redraw=!0,"";if(~this._.strokeColor.toString().indexOf("CanvasPattern"))return this._.strokeColor;if(!~this._.strokeColor.indexOf("gradient"))return this._.strokeColor;var t=this.getOrigin();if("rectangular"===this.shapeType){var e="outside"===this.strokePosition?this.strokeWidth:"center"===this.strokePosition?this.strokeWidth/2:0;return this.core.style.getGradient(this._.strokeColor,this.abs_x-t.x-e,this.abs_y-t.y-e,this.width+2*e,this.height+2*e)}if("radial"===this.shapeType){var i=this.radius+this.strokeWidth/2;return t.x+=this.radius,t.y+=this.radius,this.core.style.getGradient(this._.strokeColor,this.abs_x-t.x-this.radius,this.abs_y-t.y-this.radius,2*i,2*i)}},get strokeWidth(){return this._.strokeWidth},get strokePosition(){return this._.strokePosition},get cap(){return this._.cap},get join(){return this._.join},get miterLimit(){return this._.miterLimit},set fill(t){if(~t.indexOf("image(")){var e=/image\((.*?)(,(\s|)(repeat|repeat-x|repeat-y|no-repeat)|)\)/.exec(t),i=e[1],r=e[4]||"repeat",s=new Image,n=this;s.src=i,this._.pattern_loading=!0,this._.pattern_redraw=!1,s.onload=function(){n._.fill=n.core.canvas.createPattern(this,r),n._.pattern_loading=!1,n._.pattern_redraw&&(n._.pattern_redraw=!1,n.redraw())}}else this._.fill=t},get fill(){if(this._.pattern_loading)return this._.pattern_redraw=!0,"";if(~this._.fill.toString().indexOf("CanvasPattern"))return this._.fill;if(!~this._.fill.indexOf("gradient"))return this._.fill;var t=this.getOrigin();return"rectangular"===this.shapeType?this.core.style.getGradient(this._.fill,this.abs_x-t.x,this.abs_y-t.y,this.width,this.height):"radial"===this.shapeType?this.core.style.getGradient(this._.fill,this.abs_x-t.x-this.radius,this.abs_y-t.y-this.radius,2*this.radius,2*this.radius):void 0},set shadow(t){"string"!=typeof t&&(t=this.core.style.getShadow(t,"string"));var e=this.core.style.getShadow(t);this._.shadow=e},set shadowOffsetX(t){isNaN(parseFloat(t))||(this._.shadow.offsetX=parseFloat(t))},set shadowOffsetY(t){isNaN(parseFloat(t))||(this._.shadow.offsetY=parseFloat(t))},set shadowBlur(t){isNaN(parseFloat(t))||(this._.shadow.blur=parseFloat(t))},set shadowColor(t){this.core.style.isColor(t)&&(this._.shadow.color=t)},get shadow(){return this._.shadow},get shadowOffsetX(){return this._.shadow.offsetX},get shadowOffsetY(){return this._.shadow.offsetY},get shadowBlur(){return this._.shadow.blur},get shadowColor(){return this._.shadow.color},set x(t){if(this._.x!==t){return this._.x=t,void this.setNodeDirty()}},set y(t){if(this._.y!==t){return this._.y=t,void this.setNodeDirty()}},set pos(t){this._.x===t.x&&this._.y===t.y||(this._.x=t.x,this._.y=t.y,this.setNodeDirty())},get pos(){return{x:this._.x,y:this._.y}},set visible(t){this._visible!==t&&(this._visible=t,this.core.draw.childrenOrderDirty=!0,this.parent&&this.parent.useRenderCache&&(this.parent.textureDirty=!0))},get visible(){return this._visible},get x(){return this._.x},get y(){return this._.y},set abs_x(t){},set abs_y(t){},get abs_x(){return this._.abs_x},get abs_y(){return this._.abs_y},set width(t){this._.width!=t&&(this._.width=t,this.setNodeDirty())},get width(){return this._.width},set height(t){this._.height!=t&&(this._.height=t,this.setNodeDirty())},get height(){return this._.height},set zIndex(t){this.parent&&("front"===t&&(t=this.parent.children.length-1),"back"===t&&(t=0),this.core.draw.changeZorder(this.parent,this.zIndex,t))},get zIndex(){return this.parent&&this.parent.children.indexOf(this)},get drawn(){return!this.core.draw.isCleared&&this._.drawn},set drawn(t){this._.drawn=!!t},setDirtyFlag:function(t){0===this._dirtyFlag&&0!==t&&this.core.draw.pushDirtyNode(this),this._dirtyFlag|=t},transform:function(t,e){var i=this,r=t&&!t.useRenderCache?t._worldTransform:null,s=this._transform,n=this._worldTransform;i._rotationX=i._rotationY=i.rotation;var a=i._rotationX||i._rotationY,o=i._skewX||i._skewY,h=i.scalingX,c=i.scalingY,l=this.getOrigin(),d=l.x,f=l.y,u=1,g=0,y=0,p=1;if(a||o){if(s.tx=i.x,s.ty=i.y,a){var _=.017453292519943295*i._rotationX;if(y=Math.sin(_),p=Math.cos(_),i._rotationY===i._rotationX)u=p,g=-y;else{var v=.017453292519943295*i._rotationY;u=Math.cos(v),g=-Math.sin(v)}}if(s.a=u*=h,s.b=g*=h,s.c=y*=c,s.d=p*=c,o){var x=Math.tan(i._skewX*Math.PI/180),b=Math.tan(i._skewY*Math.PI/180);x===1/0&&(x=99999999),b===1/0&&(b=99999999),s.a=u+g*b,s.b=g+u*b,s.c=y+p*x,s.d=p+y*x}(d||f)&&(s.tx-=s.a*d+s.c*f,s.ty-=s.b*d+s.d*f,i._ignoreAnchorPointForPosition&&(s.tx+=d,s.ty+=f)),r?(n.a=s.a*r.a+s.b*r.c,n.b=s.a*r.b+s.b*r.d,n.c=s.c*r.a+s.d*r.c,n.d=s.c*r.b+s.d*r.d,n.tx=r.a*s.tx+r.c*s.ty+r.tx,n.ty=r.d*s.ty+r.ty+r.b*s.tx):(n.a=s.a,n.b=s.b,n.c=s.c,n.d=s.d,n.tx=s.tx,n.ty=s.ty)}else s.a=h,s.b=0,s.c=0,s.d=c,s.tx=i.x,s.ty=i.y,(d||f)&&(s.tx-=s.a*d,s.ty-=s.d*f),r?(n.a=s.a*r.a+s.b*r.c,n.b=s.a*r.b+s.b*r.d,n.c=s.c*r.a+s.d*r.c,n.d=s.c*r.b+s.d*r.d,n.tx=s.tx*r.a+s.ty*r.c+r.tx,n.ty=s.tx*r.b+s.ty*r.d+r.ty):(n.a=s.a,n.b=s.b,n.c=s.c,n.d=s.d,n.tx=s.tx,n.ty=s.ty);if(e&&!this.useRenderCache){var m=this.children;if(!m||0===m.length)return;var w,C;for(w=0,C=m.length;w<C;w++)m[w].transform(this,e)}this.updateViewStatus(),this._cacheDirty=!0},getNodeToParentTransform:function(){return this._dirtyFlag&this._dirtyFlags.transformDirty&&this.transform(),this._transform},needDraw:function(){return this._needDraw},visit:function(t){if(this._visible){var e=this,i=this.core.draw;(t=t||this.getParent())&&(this._curLevel=t._curLevel+1),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t),this.visitChildren()}},_updateDisplayColor:function(t){var e,i,s,a,o=this,h=this._displayedColor,c=o._realColor;if(this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){h.r=c.r,h.g=c.g,h.b=c.b;var l=new r.Color(255,255,255,255);for(e=0,i=(s=o._children).length;e<i;e++)(a=s[e])&&a._renderCmd&&a._renderCmd._updateDisplayColor(l);this._cascadeColorEnabledDirty=!1}else{if(t===n){var d=o.parent;t=d&&d._cascadeColorEnabled?d.getDisplayedColor():r.color.WHITE}if(h.r=0|c.r*t.r/255,h.g=0|c.g*t.g/255,h.b=0|c.b*t.b/255,o._cascadeColorEnabled)for(e=0,i=(s=o._children).length;e<i;e++)(a=s[e])&&a._renderCmd&&(a._renderCmd._updateDisplayColor(h),a._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&this._dirtyFlags.colorDirty^this._dirtyFlag},_updateDisplayOpacity:function(t){var e,i,r,s,a=this;if(this._cascadeOpacityEnabledDirty&&!a._cascadeOpacityEnabled){for(this._displayedOpacity=a._realOpacity,e=0,i=(r=a._children).length;e<i;e++)(s=r[e])&&s._renderCmd&&s._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(t===n){var o=a.parent;t=255,o&&o._cascadeOpacityEnabled&&(t=o.getDisplayedOpacity())}if(this._displayedOpacity=a._realOpacity*t/255,a._cascadeOpacityEnabled)for(e=0,i=(r=a._children).length;e<i;e++)(s=r[e])&&s._renderCmd&&(s._renderCmd._updateDisplayOpacity(this._displayedOpacity),s._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&this._dirtyFlags.opacityDirty^this._dirtyFlag},_syncDisplayColor:function(t){var e=this,i=this._displayedColor,s=e._realColor;if(t===n){var a=e.parent;t=a&&a._cascadeColorEnabled?a.getDisplayedColor():r.color.WHITE}i.r=0|s.r*t.r/255,i.g=0|s.g*t.g/255,i.b=0|s.b*t.b/255},_syncDisplayOpacity:function(t){var e=this;if(t===n){var i=e.parent;t=255,i&&i._cascadeOpacityEnabled&&(t=i.getDisplayedOpacity())}this._displayedOpacity=e._realOpacity*t/255},_updateColor:function(){},updateStatus:function(){var t=this._dirtyFlags,e=this._dirtyFlag,i=e&t.colorDirty,r=e&t.opacityDirty;this._savedDirtyFlag=this._savedDirtyFlag||e,i&&this._updateDisplayColor(),r&&this._updateDisplayOpacity(),(i||r)&&this._updateColor(),e&t.transformDirty&&(this.transform(this.getParent(),!0),this._dirtyFlag=this._dirtyFlag&t.transformDirty^this._dirtyFlag),e&t.orderDirty&&(this._dirtyFlag=this._dirtyFlag&t.orderDirty^this._dirtyFlag)},_syncStatus:function(t){var e=this._dirtyFlags,i=this._dirtyFlag,r=null;t?(r=t,this._savedDirtyFlag=this._savedDirtyFlag||t._savedDirtyFlag||i):this._savedDirtyFlag=this._savedDirtyFlag||i,r&&r._cascadeColorEnabled&&parentCmd._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),r&&r._cascadeOpacityEnabled&&parentCmd._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty);var s=i&e.colorDirty,n=i&e.opacityDirty;this._dirtyFlag=i,s&&this._syncDisplayColor(),n&&this._syncDisplayOpacity(),(s||n)&&this._updateColor(),i&e.transformDirty&&this.transform(t),i&e.orderDirty&&(this._dirtyFlag=this._dirtyFlag&e.orderDirty^this._dirtyFlag)},visitChildren:function(){var t,e=this.core.draw,i=this.children,r=i.length;if(e.pushRenderCommand(this),!this.useRenderCache&&r>0)for(t=0;t<r;t++)i[t].visit(this);this._dirtyFlag=0},setNodeDirty:function(){this.setDirtyFlag(this._dirtyFlags.transformDirty)},getParent:function(){return this.parent?this.parent:null},updateViewStatus:function(){if(this.mustShow)this._inViewRect=!0;else{var t=this._worldTransform,e=(t.tx,t.ty),i=this.height,r=sharedCanvas.height;this._inViewRect=e>=0&&e<=r||e+i>=0&&e+i<=r||e<=0&&e+i>=r}},isInViewRect:function(){return this._inViewRect},rendering:function(t,e,i){},bind:function(t,e){return this.core.events.bind(this,t.split(" "),e),this},unbind:function(t,e){return this.core.events.unbind(this,t.split(" "),e),this},trigger:function(t,e){var i=this.core.events,r=i.getParentChain(this,!0,!0);return i.triggerChain(r,t.split(" "),i.fixEventObject(e)),this},add:function(t){return this.added||(t=t===n||t,this.core.children.push(this),this.added=!0,this.parent=this.core,t&&this.core.draw.redraw(),this.core.draw.childrenOrderDirty=!0),this},remove:function(t){if(t=t===n||t,!this.parent)return this;var e=this.parent.children.indexOf(this);if(~e){this.parent.children.splice(e,1),this.parent=n,this.added=!1,this.drawn=!1,this.textureDirty=!1,this._cacheCanvas=null;for(var i=this.children,r=0,s=i.length;r<s;r++)i[r].drawn=!1;this.core.draw.childrenOrderDirty=!0,this.textureDirty=!0,this.setNodeDirty(),t&&this.core.draw.redraw()}return this},draw:function(t){},redraw:function(){return this.core.draw.redraw(),this},rotate:function(t){return this.rotation+=t,this},rotateTo:function(t){return this.rotation=t,this},getArgs:function(t,e,i,r){if(i=i||0,r=r||0,"string"==typeof e){var s=e,a=t;t="x"===s?a:i,e="y"===s?a:r}else e===n&&(e=t);return{x:t,y:e}},move:function(t,e){var i=this.getArgs(t,e);return this.x+=i.x,this.y+=i.y,this},moveTo:function(t,e){var i=this.getArgs(t,e,this.x,this.y);return this.x=i.x,this.y=i.y,this},scale:function(t,e){var i=this.getArgs(t,e,1,1);return this.scalingX=i.x,this.scalingY=i.y,this},scaleTo:function(t,e){var i="rectangular"===this.shapeType?this.width:this.radius,r="rectangular"===this.shapeType?this.height:this.radius,s=this.getArgs(t,e,i,r);return s.x=s.x<=0?1:s.x,s.y=s.y<=0?1:s.y,this.scalingX=s.x/i,this.scalingY=s.y/r,this},dragAndDrop:function(t){if(!1===(t=t===n?{}:t)&&!0===this.draggable)this.draggable=!1,this.unbind("mousedown touchstart",this._.drag_start),this.core.unbind("mouseup touchend",this._.drag_end),this.core.unbind("mousemove touchmove",this._.drag_move);else if(!this.draggable){this.draggable=!0,this.dragging=!1;var e=this,i={x:0,y:0},r={x:0,y:0},s={x:0,y:0};this._.drag_start=function(n){!1===t.bubble&&n.stopPropagation(),this.dragging=!0,i.x=n.x-this.x,i.y=n.y-this.y,r.x=this.x,r.y=this.y,s=e.core.tools.transformPointerPosition(e,e.abs_x,e.abs_y,e.rotation),!0===t.changeZindex&&(this.zIndex="front"),"function"==typeof t.start&&t.start.call(this),this.core.timeline.running||this.core.draw.redraw()},this._.drag_end=function(i){e.dragging&&(!1===t.bubble&&i.stopPropagation(),e.dragging=!1,"function"==typeof t.end&&t.end.call(e),e.core.timeline.running||e.core.draw.redraw())},this._.drag_move=function(i){if(e.dragging){!1===t.bubble&&i.stopPropagation();var n=e.core.tools.transformPointerPosition(e,e.abs_x,e.abs_y,e.rotation);e.x=r.x+n.x-s.x,e.y=r.y+n.y-s.y,"function"==typeof t.move&&t.move.call(e),e.core.timeline.running||e.core.draw.redraw()}},this.bind("mousedown touchstart",this._.drag_start),this.core.bind("mouseup touchend",this._.drag_end),this.core.bind("mousemove touchmove",this._.drag_move)}return this},setOrigin:function(t,e){return this.origin.x=t,this.origin.y=e,this.originDirty=!0,this.setNodeDirty(),this},getOrigin:function(){if(!this.originDirty)return{x:this.org_x,y:this.org_y};var t,e,i=this.origin,r=this.shapeType;return t="center"===i.x?"rectangular"===r?this.width/2:0:"right"===i.x?"rectangular"===r?this.width:this.radius:"left"===i.x?"rectangular"===r?0:-this.radius:isNaN(parseFloat(i.x))?0:parseFloat(i.x),e="center"===i.y?"rectangular"===r?this.height/2:0:"bottom"===i.y?"rectangular"===r?this.height:this.radius:"top"===i.y?"rectangular"===r?0:-this.radius:isNaN(parseFloat(i.y))?0:parseFloat(i.y),this.org_x=t,this.org_y=e,this.originDirty=!1,{x:t,y:e}},addChild:function(t,e){if(t.parent===n){var i=this.children.push(t)-1;if(t.parent=this,t.x+=0,t.y+=0,this.drawn&&this.core.draw.redraw(),this.textureDirty=!0,this.setNodeDirty(),e)return i}else if(e)return!1;return this},removeChild:function(t,e){var i=this.children.indexOf(t);return~i&&this.removeChildAt(i,e),r.renderer.childrenOrderDirty=!0,this},removeChildAt:function(t,e){return this.children[t]!==n&&this.children[t].remove(e),this},removeAllChildren:function(t){var e=this.children;if(null!==e){for(var i=0;i<e.length;i++){var r=e[i];r&&(r.parent=null)}this.children.length=0,this.core.draw.childrenOrderDirty=!0}},isPointerInside:function(t){return this.core.tools.isPointerInside(this,t)}}};h.registerModule("displayObject",c),h.registerModule("display",{wrapper:!0,register:function(t,e,i,r){var s=this,a=this.core,o=function(r,s){return h.extend({core:s,type:t,shapeType:"rectangular",draw:function(){return i.call(this,a.canvas,a),this}},e,r)};return this[t]=function(t){var e=h.extend(Object.create(c()),new o(t,a));return r!==n&&"function"==typeof e[r]&&e[r](),e},s}}),h.registerDisplayObject=function(t,e,i){h.registerModule("display."+t,{setCore:function(r){return function(s){var a=h.extend(Object.create(c()),new e(s,r));return a.type=t,a.id=++r.lastObjectID,i!==n&&a[i](),a}}})};h.registerDisplayObject("rendernode",function(t,e){return h.extend({core:e,shapeType:"rectangular",clipChildren:!1,useRenderCache:!0,textureDirty:!0,_cacheCanvas:null,_drawInCanvas:function(){this._cacheCanvas||(this._cacheCanvas=s.createElement("canvas"),this._cacheCanvas.width=this._cacheCanvas.height=1,this._cacheContext=new a(this._cacheCanvas.getContext("2d")));var t=this._.width,e=this._.height;this._cacheCanvas.width==t&&this._cacheCanvas.height==e||(this._cacheCanvas.width=t,this._cacheCanvas.height=e),this.core.draw._turnToCacheMode(this.id);for(var i=0,r=this.children.length;i<r;i++)this.children[i].visit(this);var n=this._cacheContext.getContext();this._cacheContext.setFillStyle(this.fill),n.fillRect(0,0,t,e),this.core.draw._renderingToCacheCanvas(this._cacheContext,this.id,1,1),this.core.draw._turnToNormalMode()},rendering:function(t,e,i){var r=this.opacity;if(0!==r){this.textureDirty&&(this._drawInCanvas(),this.textureDirty=!1);var s=t||this.core._renderContext,n=s.getContext(),a=this.width,o=this.height;s.setCompositeOperation("source-over"),s.setGlobalAlpha(r),s.setTransform(this._worldTransform,e,e),n.drawImage(this._cacheCanvas,0,0,a*e,o*i),this.core.draw.drawcalls++}}},t)});h.registerDisplayObject("rectangle",function(t,e){return h.extend({core:e,shapeType:"rectangular",clipChildren:!1,rendering:function(t,e,i){var r=t||this.core._renderContext,s=r.getContext(),n=this,a=this.opacity,o=n.width,h=n.height;0===a||0===o&&0===h||(r.setCompositeOperation("source-over"),r.setGlobalAlpha(a),r.setFillStyle(this.fill),r.setTransform(this._worldTransform,e,i),s.fillRect(0,0,o*e,h*i),this.core.draw.drawcalls++)}},t)});h.registerDisplayObject("image",function(t,e){return h.extend({core:e,_:h.extend({},e.displayObject._,{hasBeenDrawn:!1}),shapeType:"rectangular",loaded:!1,firstDrawn:!1,set url(t){this.image=t,this.loaded=!1,this.firstDrawn=!1,this.originDirty=!1,this.textureDirty=!1,this.init()},get url(){return this.image},init:function(){var t=this;if(this.image!==n){var e=this.image.nodeName&&"img"===this.image.nodeName.toLowerCase();this.img=e?this.image:null;var r=function(e,i){e?console.error("load image url failed",t.image):(0!==t.width?0===t.height&&(t.height=t.width/(i.width/i.height)):t.width=i.width,0!==t.height?0===t.width&&(t.width=t.height/(i.height/i.width)):t.height=i.height,t._.hasBeenDrawn&&t.core.redraw(),t.loaded=!0,t.originDirty=!0,t.textureDirty=!0,t.parent&&t.parent.useRenderCache&&(t.parent.textureDirty=!0),t.setNodeDirty())};e&&this.img.complete?r.call(this.img):this.img=i.load(this.image,r.bind(this))}},rendering:function(t,e,i){var s=this,n=this.opacity;if(this.loaded&&0!==n){var a=t||r._renderContext,o=a.getContext();s.height,s.width,a.setTransform(this._worldTransform,e,i),a.setCompositeOperation("source-over"),a.setGlobalAlpha(n);var h,c,l,d,f=0===this.width?this.img.width:2*this.width,u=0===this.height?this.img.height:2*this.height;h=0*e,c=0*i,l=f*e,d=u*i,o.drawImage(this.img,h,c,l,d),this.core.draw.drawcalls++}}},t)},"init");var l=[];h.registerDisplayObject("text",function(t,e){var i=function(t,e,i,r,s){var n=s.style.getFont(t.font);n[e]=i,t._.font=s.style.getFont(n,"string"),"lineHeight"===r?(t._.lineHeight=isNaN(parseInt(i,10))?1:parseInt(i,10),t._.lineHeightUnit="string"==typeof i&&i.indexOf("px")>-1?"px":"relative"):t._[r]=i};return h.extend({core:e,textureDirty:!0,_cacheCanvas:null,shapeType:"rectangular",align:"start",baseline:"top",_:h.extend({},e.displayObject._,{hasBeenDrawn:!1,font:"normal normal normal 16px/1 sans-serif",style:"normal",variant:"normal",weight:"normal",size:16,lineHeight:1,family:"sans-serif",text:"",width:0,height:0,lines:[],renderWidth:0,renderHeight:0}),set font(t){"string"!=typeof t&&(t=this.core.style.getFont(t,"string"));var e=this.core.style.getFont(t);t=this.core.style.getFont(e,"string"),this._.style=e.style,this._.variant=e.variant,this._.weight=e.weight,this._.size=e.size,this._.lineHeight=e.lineHeight,this._.lineHeightUnit=e.lineHeightUnit,this._.family=e.family,this._.font=t,this.initWebFont(),this.setDimensions()},set style(t){i(this,"style",t,"style",this.core),this.initWebFont(),this.setDimensions()},set variant(t){i(this,"variant",t,"variant",this.core),this.initWebFont(),this.setDimensions()},set weight(t){i(this,"weight",t,"weight",this.core),this.initWebFont(),this.setDimensions()},set size(t){i(this,"size",t,"size",this.core),this.setDimensions()},set lineHeight(t){i(this,"lineHeight",t,"lineHeight",this.core),this.setDimensions()},set family(t){i(this,"family",t,"family",this.core),this.initWebFont(),this.setDimensions()},set text(t){this._.text=t,this.setDimensions()},set width(t){},set height(t){},get font(){return this._.font},get style(){return this._.style},get variant(){return this._.variant},get weight(){return this._.weight},get size(){return this._.size},get lineHeight(){return this._.lineHeight+("px"===this._.lineHeightUnit?"px":0)},get family(){return this._.family},get text(){return this._.text},get width(){return this._.width},get height(){return this._.height},init:function(){this._.initialized=!0,this._cacheCanvas||(this._cacheCanvas=s.createElement("canvas"),this._cacheCanvas.width=this._cacheCanvas.height=1),this.initWebFont(),this.setDimensions()},getFontStr:function(){var t=this.core.draw.getPixelRatio(),e=this._.style,i=this._.variant,r=this._.weight,s=this._.size,n=this._.lineHeight,a=this._.lineHeightUnit,o=this._.family;return e+" "+i+" "+r+" "+s*t+"px/"+n+("px"===a?"px":"")+" "+o},setDimensions:function(){if(this._.initialized){var t,e,i,r,s,n,a,o,h;for((t=this._cacheCanvas.getContext("2d")).setTransform(1,0,0,1,0,0),t.fillStyle=this.fill,t.font=this.getFontStr(),i=(e=this.text.toString().split("\n")).length,s=0,n=0,h=[],a=0;a<i;a++)s=(o=t.measureText(e[a])).width>s?o.width:s,n+=r="px"===this._.lineHeightUnit?this._.lineHeight:this.size*this.core.draw.getPixelRatio()*this._.lineHeight,h.push({text:e[a],width:Math.ceil(o.width),height:Math.ceil(r)});var c=this.core.draw.getPixelRatio();this._.width=s=Math.ceil(s/c),this._.height=n=Math.ceil(n/c)+2,this._.renderWidth=s*c,this._.renderHeight=n*c,this._.lines=h,this.originDirty=!0,this.textureDirty=!0,this.setNodeDirty(),this.parent&&this.parent.useRenderCache&&(this.parent.textureDirty=!0)}},initWebFont:function(){var t=this.style+" "+this.variant+" "+this.weight+" 0px "+this.family;if(!(l.indexOf(t)>-1)){l.push(t);var e,i=this,r=this.core;(e=s.createElement("span")).style.font=t,s.body.appendChild(e),setTimeout(function(){s.body.removeChild(e),i._.hasBeenDrawn&&r.redraw()},1e3)}},getAlignOffset:function(){return{start:"rtl"===this.core.canvasElement.dir?-this.width:0,end:"rtl"===this.core.canvasElement.dir?0:-this.width,left:0,center:-this.width/2,right:-this.width}[this.align]||0},getBaselineOffset:function(){return{top:.82*this.size,hanging:.65*this.size,middle:.31*this.size,alphabetic:0,ideographic:-.05*this.size,bottom:-.22*this.size}[this.baseline]||0},_drawInCanvas:function(){var t,e,i,r,s,n,a,o,h,c,l=!0,d=this._.renderWidth,f=this._.renderHeight;this._cacheCanvas.width==d&&this._cacheCanvas.height==f||(this._cacheCanvas.width=d,this._cacheCanvas.height=f,l=!1),t=this._cacheCanvas.getContext("2d"),l&&t.clearRect(0,0,d,f);var u=this.core.draw.getPixelRatio();e=this._.lines;var g=this.size*u;if(i=this.getAlignOffset(),r=this.getBaselineOffset(),s="px"===this._.lineHeightUnit?this._.lineHeight/g:this._.lineHeight,n="top"!==this.baseline?g*(s-1)/2:0,a=Math.ceil(-i)*u,o=Math.ceil(r-n)*u,t.lineWidth=1,t.font=this.getFontStr(),t.textAlign=this.align,t.textBaseline="alphabetic",this.strokeWidth>0)for(t.lineWidth=this.strokeWidth,t.strokeStyle=this.strokeColor,h=0,c=e.length;h<c;h++)t.strokeText(e[h].text,a,o+h*e[h].height+(e[h].height-g)/2);if(""!==this.fill)for(t.fillStyle=this.fill,h=0,c=e.length;h<c;h++)t.fillText(e[h].text,a,o+h*e[h].height+(e[h].height-g)/2);return this},rendering:function(t,e,i){this.textureDirty&&(this._drawInCanvas(),this.textureDirty=!1);var r=this,s=this.opacity;if(0!==s){var n=t||this.draw._renderContext,a=n.getContext();r.height,r.width;n.setTransform(this._worldTransform,e,i),n.setCompositeOperation("source-over"),n.setGlobalAlpha(s);var o,h,c,l;o=this._.renderWidth,h=this._.renderHeight,c=0*e,l=0*i,a.drawImage(this._cacheCanvas,c,l,o,h),this.core.draw.drawcalls++}}},t)},"init")}(window,document),function(){var t=Object.prototype,e=t.__defineGetter__,i=t.__defineSetter__,r=t.__lookupGetter__,s=t.__lookupSetter__,n=t.hasOwnProperty;e&&i&&r&&s&&(Object.defineProperty||(Object.defineProperty=function(t,a,o){if(arguments.length<3)throw new TypeError("Arguments not optional");if(a+="",n.call(o,"value")&&(r.call(t,a)||s.call(t,a)||(t[a]=o.value),n.call(o,"get")||n.call(o,"set")))throw new TypeError("Cannot specify an accessor and a value");return o.get&&e.call(t,a,o.get),o.set&&i.call(t,a,o.set),t}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,e){if(arguments.length<2)throw new TypeError("Arguments not optional.");e+="";var i={configurable:!0,enumerable:!0,writable:!0},a=r.call(t,e),o=s.call(t,e);return n.call(t,e)?a||o?(delete i.writable,i.get=i.set=void 0,a&&(i.get=a),o&&(i.set=o),i):(i.value=t[e],i):i}),Object.defineProperties||(Object.defineProperties=function(t,e){for(var i in e)n.call(e,i)&&Object.defineProperty(t,i,e[i])}))}(); 
 			});
 		define("third/subContext/weapp-adapter.js", function(require, module, exports){ 			
"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),r=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=GameGlobal;GameGlobal.__isAdapterInjected||(GameGlobal.__isAdapterInjected=!0,function(){o.addEventListener=function(e,t){o.document.addEventListener(e,t)},o.removeEventListener=function(e,t){o.document.removeEventListener(e,t)},o.canvas&&(o.canvas.addEventListener=o.addEventListener,o.canvas.removeEventListener=o.removeEventListener),i.sharedCanvas&&(sharedCanvas.__proto__.__proto__=new r.default("canvas"),sharedCanvas.getBoundingClientRect=function(){return{top:0,left:0,width:window.innerWidth,height:window.innerHeight}},sharedCanvas.addEventListener=o.addEventListener,sharedCanvas.removeEventListener=o.removeEventListener);var e=wx.getSystemInfoSync().platform;if("undefined"==typeof __devtoolssubcontext&&"devtools"===e){for(var t in o){var n=Object.getOwnPropertyDescriptor(i,t);n&&!0!==n.configurable||Object.defineProperty(window,t,{value:o[t]})}for(var a in o.document){var u=Object.getOwnPropertyDescriptor(i.document,a);u&&!0!==u.configurable||Object.defineProperty(i.document,a,{value:o.document[a]})}window.parent=window}else{for(var c in o)i[c]=o[c];i.window=o,window=i,window.top=window.parent=window}}())},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.cancelAnimationFrame=t.requestAnimationFrame=t.clearInterval=t.clearTimeout=t.setInterval=t.setTimeout=t.canvas=t.location=t.localStorage=t.HTMLElement=t.FileReader=t.Audio=t.Image=t.WebSocket=t.XMLHttpRequest=t.navigator=t.document=void 0;var r=n(2);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(3);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=o(n(9)),u=n(17),c=o(n(10)),l=o(n(18)),s=o(n(19)),f=o(n(20)),d=o(n(11)),p=o(n(12)),h=o(n(21)),y=o(n(4)),v=o(n(22)),b=o(n(23));t.document=c.default,t.navigator=l.default,t.XMLHttpRequest=s.default,t.WebSocket=f.default,t.Image=d.default,t.Audio=p.default,t.FileReader=h.default,t.HTMLElement=y.default,t.localStorage=v.default,t.location=b.default;var g=(0,u.isSubContext)()?void 0:new a.default;t.canvas=g,t.setTimeout=setTimeout,t.setInterval=setInterval,t.clearTimeout=clearTimeout,t.clearInterval=clearInterval,t.requestAnimationFrame=requestAnimationFrame,t.cancelAnimationFrame=cancelAnimationFrame},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=wx.getSystemInfoSync(),o=n.screenWidth,r=n.screenHeight,i=n.devicePixelRatio,a=t.innerWidth=o,u=t.innerHeight=r;t.devicePixelRatio=i;t.screen={availWidth:a,availHeight:u},t.performance={now:function(){return Date.now()/1e3}},t.ontouchstart=null,t.ontouchmove=null,t.ontouchend=null},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HTMLCanvasElement=n.HTMLImageElement=void 0;var u=function(e){return e&&e.__esModule?e:{default:e}}(o(4));n.HTMLImageElement=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"img"))}return a(t,u.default),t}(),n.HTMLCanvasElement=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"canvas"))}return a(t,u.default),t}()},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function(e){return e&&e.__esModule?e:{default:e}}(o(5)),l=o(8),s=o(2),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.className="",n.childern=[],n.style={width:s.innerWidth+"px",height:s.innerHeight+"px"},n.insertBefore=l.noop,n.innerHTML="",n.tagName=e.toUpperCase(),n}return a(t,c.default),u(t,[{key:"setAttribute",value:function(e,t){this[e]=t}},{key:"getAttribute",value:function(e){return this[e]}},{key:"getBoundingClientRect",value:function(){return{top:0,left:0,width:s.innerWidth,height:s.innerHeight}}},{key:"focus",value:function(){}},{key:"clientWidth",get:function(){var e=parseInt(this.style.fontSize,10)*this.innerHTML.length;return Number.isNaN(e)?0:e}},{key:"clientHeight",get:function(){var e=parseInt(this.style.fontSize,10);return Number.isNaN(e)?0:e}}]),t}();n.default=f},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(e){return e&&e.__esModule?e:{default:e}}(o(6)),c=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.className="",e.children=[],e}return a(t,u.default),t}();n.default=c},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function(e){return e&&e.__esModule?e:{default:e}}(o(7)),l=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.childNodes=[],e}return a(t,c.default),u(t,[{key:"appendChild",value:function(e){if(!(e instanceof t))throw new TypeError("Failed to executed 'appendChild' on 'Node': parameter 1 is not of type 'Node'.");this.childNodes.push(e)}},{key:"cloneNode",value:function(){var e=Object.create(this);return Object.assign(e,this),e}},{key:"removeChild",value:function(e){var t=this.childNodes.findIndex(function(t){return t===e});return t>-1?this.childNodes.splice(t,1):null}}]),t}();n.default=l},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=new WeakMap,i=function(){function e(){n(this,e),r.set(this,{})}return o(e,[{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.get(this);o||(o={},r.set(this,o)),o[e]||(o[e]=[]),o[e].push(t),n.capture&&console.warn("EventTarget.addEventListener: options.capture is not implemented."),n.once&&console.warn("EventTarget.addEventListener: options.once is not implemented."),n.passive&&console.warn("EventTarget.addEventListener: options.passive is not implemented.")}},{key:"removeEventListener",value:function(e,t){var n=r.get(this)[e];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===t){n.splice(o,1);break}}},{key:"dispatchEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.get(this)[e.type];if(t)for(var n=0;n<t.length;n++)t[n](e)}}]),e}();t.default=i},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.noop=function(){},t.isSubContext=function(){return"undefined"!=typeof GameGlobal&&!0===GameGlobal.__isSubContext}},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=wx.createCanvas();e.type="canvas",e.__proto__.__proto__=new r.default("canvas");e.getContext;return e.getBoundingClientRect=function(){return{top:0,left:0,width:window.innerWidth,height:window.innerHeight}},e};n(3);var r=o(n(4));o(n(10))},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),i=o(n(4)),a=o(n(11)),u=o(n(12)),c=o(n(9));n(15);var l={},s={readyState:"complete",visibilityState:"visible",documentElement:r,hidden:!1,style:{},location:r.location,ontouchstart:null,ontouchmove:null,ontouchend:null,head:new i.default("head"),body:new i.default("body"),createElement:function(e){return"canvas"===e?new c.default:"audio"===e?new u.default:"img"===e?new a.default:new i.default(e)},getElementById:function(e){return e===r.canvas.id?r.canvas:null},getElementsByTagName:function(e){return"head"===e?[s.head]:"body"===e?[s.body]:"canvas"===e?[r.canvas]:[]},querySelector:function(e){return"head"===e?s.head:"body"===e?s.body:"canvas"===e?r.canvas:e==="#"+r.canvas.id?r.canvas:null},querySelectorAll:function(e){return"head"===e?[s.head]:"body"===e?[s.body]:"canvas"===e?[r.canvas]:[]},addEventListener:function(e,t){l[e]||(l[e]=[]),l[e].push(t)},removeEventListener:function(e,t){var n=l[e];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===t){n.splice(o,1);break}},dispatchEvent:function(e){var t=l[e.type];if(t)for(var n=0;n<t.length;n++)t[n](e)}};t.default=s},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return wx.createImage()}},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function(e){return e&&e.__esModule?e:{default:e}}(o(13)),l=o(8),s=0,f=1,d=2,p=3,h=4,y=new WeakMap,v=new WeakMap,b=(new WeakMap,new WeakMap,function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(n.HAVE_NOTHING=s,n.HAVE_METADATA=f,n.HAVE_CURRENT_DATA=d,n.HAVE_FUTURE_DATA=p,n.HAVE_ENOUGH_DATA=h,n.readyState=s,(0,l.isSubContext)())return console.warn("HTMLAudioElement is not supported in SubContext."),i(n);v.set(n,"");var o=wx.createInnerAudioContext();return y.set(n,o),o.onCanplay(function(){n.dispatchEvent({type:"load"}),n.dispatchEvent({type:"loadend"}),n.dispatchEvent({type:"canplay"}),n.dispatchEvent({type:"canplaythrough"}),n.dispatchEvent({type:"loadedmetadata"}),n.readyState=d}),o.onPlay(function(){n.dispatchEvent({type:"play"})}),o.onPause(function(){n.dispatchEvent({type:"pause"})}),o.onEnded(function(){n.dispatchEvent({type:"ended"}),n.readyState=h}),o.onError(function(){n.dispatchEvent({type:"error"})}),e&&(y.get(n).src=e),n}return a(t,c.default),u(t,[{key:"load",value:function(){console.warn("HTMLAudioElement.load() is not implemented.")}},{key:"play",value:function(){(0,l.isSubContext)()||y.get(this).play()}},{key:"pause",value:function(){(0,l.isSubContext)()||y.get(this).pause()}},{key:"canPlayType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"!=typeof e?"":e.indexOf("audio/mpeg")>-1||e.indexOf("audio/mp4")?"probably":""}},{key:"cloneNode",value:function(){var e=new t;return(0,l.isSubContext)()||(e.loop=y.get(this).loop,e.autoplay=y.get(this).loop,e.src=this.src),e}},{key:"currentTime",get:function(){return(0,l.isSubContext)()?0:y.get(this).currentTime},set:function(e){(0,l.isSubContext)()||y.get(this).seek(e)}},{key:"src",get:function(){return v.get(this)},set:function(e){v.set(this,e),(0,l.isSubContext)()||(y.get(this).src=e)}},{key:"loop",get:function(){return!(0,l.isSubContext)()&&y.get(this).loop},set:function(e){(0,l.isSubContext)()||(y.get(this).loop=e)}},{key:"autoplay",get:function(){return!(0,l.isSubContext)()&&y.get(this).autoplay},set:function(e){(0,l.isSubContext)()||(y.get(this).autoplay=e)}},{key:"paused",get:function(){return!(0,l.isSubContext)()&&y.get(this).paused}}]),t}());n.default=b},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(e){return e&&e.__esModule?e:{default:e}}(o(14)),c=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"audio"))}return a(t,u.default),t}();n.default=c},function(t,n,o){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==(void 0===n?"undefined":e(n))&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+(void 0===n?"undefined":e(n)));t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=function(e){return e&&e.__esModule?e:{default:e}}(o(4)),l=function(e){function t(e){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,c.default),u(t,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),t}();n.default=l},function(e,t,n){n(16)},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return function(t){var n=new c(e);n.touches=t.touches,n.targetTouches=Array.prototype.slice.call(t.touches),n.changedTouches=t.changedTouches,n.timeStamp=t.timeStamp,a.default.dispatchEvent(n)}}var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1)),a=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),u=n(8),c=function e(t){o(this,e),this.target=i.canvas,this.currentTarget=i.canvas,this.touches=[],this.targetTouches=[],this.changedTouches=[],this.preventDefault=u.noop,this.stopPropagation=u.noop,this.type=t};wx.onTouchStart(r("touchstart")),wx.onTouchMove(r("touchmove")),wx.onTouchEnd(r("touchend")),wx.onTouchCancel(r("touchcancel"))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.noop=function(){},t.isSubContext=function(){return"undefined"!=typeof GameGlobal&&!0===GameGlobal.__isSubContext}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r={platform:wx.getSystemInfoSync().platform,language:"zh-cn",appVersion:"5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN",onLine:!0,geolocation:{getCurrentPosition:o.noop,watchPosition:o.noop,clearWatch:o.noop}};t.default=r},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if("function"==typeof this["on"+e]){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this["on"+e].apply(this,n)}}function r(e){this.readyState=e,o.call(this,"readystatechange")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=new WeakMap,u=new WeakMap,c=new WeakMap,l=new WeakMap,s=new WeakMap,f=function(){function e(){n(this,e),this.onabort=null,this.onerror=null,this.onload=null,this.onloadstart=null,this.onprogress=null,this.ontimeout=null,this.onloadend=null,this.onreadystatechange=null,this.readyState=0,this.response=null,this.responseText=null,this.responseType="",this.responseXML=null,this.status=0,this.statusText="",this.upload={},this.withCredentials=!1,c.set(this,{"content-type":"application/x-www-form-urlencoded"}),l.set(this,{})}return i(e,[{key:"abort",value:function(){var e=s.get(this);e&&e.abort()}},{key:"getAllResponseHeaders",value:function(){var e=l.get(this);return Object.keys(e).map(function(t){return t+": "+e[t]}).join("\n")}},{key:"getResponseHeader",value:function(e){return l.get(this)[e]}},{key:"open",value:function(t,n){u.set(this,t),a.set(this,n),r.call(this,e.OPENED)}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.readyState!==e.OPENED)throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");wx.request({data:n,url:a.get(this),method:u.get(this),header:c.get(this),responseType:this.responseType,success:function(n){var i=n.data,a=n.statusCode,u=n.header;if("string"!=typeof i&&!(i instanceof ArrayBuffer))try{i=JSON.stringify(i)}catch(e){i=i}if(t.status=a,l.set(t,u),o.call(t,"loadstart"),r.call(t,e.HEADERS_RECEIVED),r.call(t,e.LOADING),t.response=i,i instanceof ArrayBuffer){t.responseText="";for(var c=new Uint8Array(i),s=c.byteLength,f=0;f<s;f++)t.responseText+=String.fromCharCode(c[f])}else t.responseText=i;r.call(t,e.DONE),o.call(t,"load"),o.call(t,"loadend")},fail:function(e){var n=e.errMsg;-1!==n.indexOf("abort")?o.call(t,"abort"):o.call(t,"error",n),o.call(t,"loadend")}})}},{key:"setRequestHeader",value:function(e,t){var n=c.get(this);n[e]=t,c.set(this,n)}}]),e}();f.UNSEND=0,f.OPENED=1,f.HEADERS_RECEIVED=2,f.LOADING=3,f.DONE=4,t.default=f},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(8),a=new WeakMap,u=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(o(this,e),this.binaryType="",this.bufferedAmount=0,this.extensions="",this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.protocol="",this.readyState=3,(0,i.isSubContext)())throw new Error("WebSocket is not supported in SubContext.");if("string"!=typeof t||!/(^ws:\/\/)|(^wss:\/\/)/.test(t))throw new TypeError("Failed to construct 'WebSocket': The URL '"+t+"' is invalid");this.url=t,this.readyState=e.CONNECTING;var u=wx.connectSocket({url:t,protocols:Array.isArray(r)?r:[r]});return a.set(this,u),u.onClose(function(t){n.readyState=e.CLOSED,"function"==typeof n.onclose&&n.onclose(t)}),u.onMessage(function(e){"function"==typeof n.onmessage&&n.onmessage(e)}),u.onOpen(function(){n.readyState=e.OPEN,"function"==typeof n.onopen&&n.onopen()}),u.onError(function(e){"function"==typeof n.onerror&&n.onerror(new Error(e.errMsg))}),this}return r(e,[{key:"close",value:function(t,n){this.readyState=e.CLOSING,a.get(this).close({code:t,reason:n})}},{key:"send",value:function(e){if("string"!=typeof e&&!(e instanceof ArrayBuffer))throw new TypeError("Failed to send message: The data "+e+" is invalid");a.get(this).send({data:e})}}]),e}();u.CONNECTING=0,u.OPEN=1,u.CLOSING=2,u.CLOSED=3,t.default=u},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(8),a=function(){function e(){o(this,e)}return r(e,[{key:"construct",value:function(){if((0,i.isSubContext)())throw new Error("FileReader is not supported in SubContext.")}}]),e}();t.default=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o={get length(){return wx.getStorageInfoSync().keys.length},key:function(e){return wx.getStorageInfoSync().keys[e]},getItem:function(e){return wx.getStorageSync(e)},setItem:function(e,t){return wx.setStorageSync(e,t)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},r={},i={get length(){return Object.keys(r).length},key:function(e){return Object.keys(r)[e]},getItem:function(e){return r[e]},setItem:function(e,t){r[e]=t},removeItem:function(e){delete r[e]},clear:function(){r={}}},a=(0,n(8).isSubContext)()?i:o;t.default=a},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={href:"game.js",reload:function(){}};t.default=n}]); 
 			});
 		define("third/subContext/sub.js", function(require, module, exports){ 			
"use strict";function t(t,i,e,n){var o="";t<0&&(o="-",t=Math.abs(t)),void 0!==i&&null!==i||(i=1),void 0!==n&&null!==n||(n=!0),void 0!==e&&null!==e||(e=!0);var r=t.toString(),a=r.indexOf(".");if(-1!=a)if(r.length>a+i)r=r.substring(0,a+i+1);else for(var s=0;s<a+i+1-r.length;s++)r+="0";if(n){for(var h=r.split("."),l=parseInt(h[0]),c="";l>1e3;)""!=c&&(c=","+c),c=l.toString().slice(-3)+c,l=parseInt(l/1e3);l>0&&(c=""!=c?l.toString()+","+c:l.toString()),","==c.charAt(0)&&(c=c.slice(1)),""==c&&(c="0"),h[0]=o+c,r=h.length>1?h.join("."):h[0]}return r}function i(i,e,n,o,r){void 0!==e&&null!==e||(e=1),void 0!==o&&null!==o||(o=!1),void 0!==r&&null!==r||(r=!1),void 0!==n&&null!==n||(n=!0);var a="";i<0&&(a="-");var s="";return(i=Math.abs(i))>=1e8?(i/=1e8,s=""):i>=1e4?(i/=1e4,s=""):i>=1e3&&o&&(i/=1e3,s=""),a+t(i,e,n,r)+s}function e(t,i,e){if(!t)return t;i=i||19,e||(e="");for(var n=0,o="",r=!1,a=0;a<t.length;++a){if(n>i){r=!0;break}if((n+=t.charCodeAt(a)>255?2:1)>=i){r=!0;break}o+=t.charAt(a)}return r&&(o+=e),o}function n(t,i,e,n){this.posx=t||0,this.posy=i||0,this.type=n||u.Coin,this._initConfig(e),this.init()}function o(t){this.init(t),this.setTouchEnabled(!1)}function r(){return new Promise(function(t,i){wx.getFriendUserGameData({success:function(i){t(i.data)},fail:function(t){i(t.errMsg)}})})}function a(t,i){return t.coin>i.coin?-1:t.coin<i.coin?1:0}function s(t,i){return t.gain>i.gain?-1:t.gain<i.gain?1:0}function h(t){var i=p,e=[];if(i&&i.length>=1){(i=i.sort(t==u.Coin?a:s))[0].rank=1,e.push(i[0]);for(var n,o,r=i[0].isSelf,h=t==u.Coin?i[0].coin:i[0].gain,l=1,c=i.length;l<c;l++)if(o=t==u.Coin?i[l].coin:i[l].gain,n=o==h?i[l-1].rank:l+1,i[l].rank=n,h=o,r=r||i[l].isSelf,l<30)e.push(i[l]);else if(r){e.push(i[l]);break}}g&&g.update(e,t)}function l(t){r().then(function(t){var i=t.map(function(t){var i={avatarUrl:t.avatarUrl,nickName:t.nickName},e=0,n=0;try{for(var o=JSON.parse(t.buffer).wxgame.rank,r=0,a=o.length;r<a;r++)"coin"==o[r].key?e=o[r].value1:"gain"==o[r].key&&(n=o[r].value1)}catch(t){console.error(t)}return i.coin=e,i.gain=n,"selfOpenId"==t.openId||null!=T&&t.openId==T?i.isSelf=!0:i.isSelf=!1,i});console.error("",i),p=i||[],h(f)}).catch(function(t){console.error("getFriendUserGameData error",t)})}console.error(""),require("weapp-adapter.js"),window.pageXOffset=window.pageXOffset||0,window.pageYOffset=window.pageYOffset||0;require("ocanvas-2.8.10_wx.js");var c=oCanvas.create({canvas:sharedCanvas,fps:60,drawEachFrame:!0,clearEachFrame:!0}),u={};u.Coin=1,u.Gain=2,n.prototype._initConfig=function(t){t=t||{},this.name=e(t.nickName||"adf..."+Math.floor(1e3*Math.random()).toString()+"a",12),this.rank=t.rank||0,this.faceURL=t.avatarUrl||"res/inner/defaultFaces/default_face_boy.png",this.coin=i(t.coin||0,2),this.gain=t.gain||0,this.isSelf=t.isSelf||!1},n.prototype.setPosition=function(t){this.rankItem.pos=t},n.prototype.init=function(){var t=this.isSelf?"#6A70F3":"#fff",i=this.isSelf?"#fff":"#676767",e=this.isSelf?"UI_zhezhaolan60.png":"UI_zhezhaobai60.png";this.rankItem=c.display.rendernode({x:2*this.posx,y:2*this.posy,origin:{x:"center",y:"center"},width:1280,height:220,fill:t}),this.image_rank=c.display.image({x:74.28,y:110,origin:{x:"center",y:"center"},image:"res/inner/paixing/UI_huangguan"+(this.rank>=4?4:this.rank).toString()+".png",width:39,height:33}),this.rankItem.addChild(this.image_rank),this.rankText=c.display.text({x:84.28,y:130,origin:{x:"center",y:"center"},align:"center",font:"normal "+(this.rank<=3?18:22)+"px Arial",text:this.rank.toString(),fill:this.rank>3?"#676767":"#ffffff"}),this.rankItem.addChild(this.rankText),this.spH=c.display.rectangle({x:640,y:220,origin:{x:"center",y:"center"},width:1052,height:8,fill:"#EBEBEB"}),this.rankItem.addChild(this.spH),this.image_avatar=c.display.image({x:232.78,y:110,origin:{x:"center",y:"center"},default:"res/inner/defaultFaces/default_face_boy.png",image:this.faceURL,height:60,width:60}),this.rankItem.addChild(this.image_avatar),this.image_spr=c.display.image({x:232.78,y:110,origin:{x:"center",y:"center"},image:"res/inner/paixing/"+e,height:62,width:62}),this.rankItem.addChild(this.image_spr),this.text_name=c.display.text({x:341.82,y:130,origin:{x:"left",y:"center"},align:"center",font:"normal 24px Arial",fill:i,text:this.name.toString()}),this.rankItem.addChild(this.text_name),this.img_coin=c.display.image({x:876.42,y:130,origin:{x:"center",y:"center"},image:"res/inner/paixing/UI_jinbi.png"}),this.rankItem.addChild(this.img_coin),this.text_coin=c.display.text({x:937.78,y:130,origin:{x:"left",y:"center"},align:"center",font:"normal 24px Arial",text:this.coin.toString(),fill:"#F89F35"}),this.rankItem.addChild(this.text_coin),this.img_coin_dichi=c.display.image({x:736.42,y:130,origin:{x:"center",y:"center"},image:"res/inner/paixing/UI_dichi"+(this.rank>=4?4:this.rank).toString()+".png"}),this.rankItem.addChild(this.img_coin_dichi),this.text_gain_beg=c.display.text({x:818.78,y:130,origin:{x:"left",y:"center"},align:"center",font:"normal 24px Arial",text:"",fill:i}),this.rankItem.addChild(this.text_gain_beg),this.text_beg_width=this.text_gain_beg.width,this.text_gain=c.display.text({x:this.text_gain_beg.x+2*this.text_gain_beg.width,y:130,origin:{x:"left",y:"center"},align:"center",font:"normal 24px Arial",text:this.gain.toString(),fill:"#F89F35"}),this.rankItem.addChild(this.text_gain),this.text_gain_end=c.display.text({x:this.text_gain.x+2*this.text_gain.width,y:130,origin:{x:"left",y:"center"},align:"center",font:"normal 24px Arial",text:"",fill:i}),this.rankItem.addChild(this.text_gain_end);var n=this.type===u.Coin,o=this.type===u.Gain;this.spH.visible=!this.isSelf,this.image_rank.visible=this.rank<=3,this.img_coin.visible=n,this.text_coin.visible=n,this.img_coin_dichi.visible=o,this.text_gain_beg.visible=o,this.text_gain.visible=o,this.text_gain_end.visible=o},n.prototype.update=function(t,i){if(t){this._initConfig(t),i=i||u.Coin,this.type=i;var e=this.isSelf?"#6A70F3":"#fff",n=this.isSelf?"#fff":"#676767",o=this.isSelf?"UI_zhezhaolan60.png":"UI_zhezhaobai60.png",r=this.type===u.Coin,a=this.type===u.Gain;this.spH.visible=!this.isSelf,this.rankItem.fill=e;this.image_rank.url;this.image_rank.url="res/inner/paixing/UI_huangguan"+(this.rank>=4?4:this.rank).toString()+".png",this.image_rank.visible=this.rank<=3,this.rankText.fill=this.rank>3?"#676767":"#fff",this.rankText.y=2*(55+(this.rank>3?0:10)),this.rankText.font="normal "+(this.rank<=3?18:22)+"px Arial",this.rankText.text=this.rank.toString(),this.image_avatar.url=this.faceURL,this.image_spr.url="res/inner/paixing/"+o,this.text_name.text=this.name,this.text_name.fill=n,this.img_coin.visible=r,this.text_coin.visible=r,this.img_coin_dichi.visible=a,this.text_gain_beg.visible=a,this.text_gain.visible=a,this.text_gain_end.visible=a,r?(this.text_coin.text=this.coin.toString(),this.img_coin_dichi.url="res/inner/paixing/UI_dichi"+(this.rank>=4?4:this.rank).toString()+".png"):(this.text_gain_beg.fill=n,this.text_gain.text=this.gain.toString(),this.text_gain_end.fill=n,this.text_gain_end.x=this.text_gain.x+2*this.text_gain.width)}else this.rankItem.visible=!1};var _={};_.ScrollView={},_.ScrollView.DIR_NONE=0,_.ScrollView.DIR_VERTICAL=1,_.ScrollView.DIR_HORIZONTAL=2,_.ScrollView.DIR_BOTH=3,_.ScrollView.EVENT_SCROLL_TO_TOP=0,_.ScrollView.EVENT_SCROLL_TO_BOTTOM=1,_.ScrollView.EVENT_SCROLL_TO_LEFT=2,_.ScrollView.EVENT_SCROLL_TO_RIGHT=3,_.ScrollView.EVENT_SCROLLING=4,_.ScrollView.EVENT_BOUNCE_TOP=5,_.ScrollView.EVENT_BOUNCE_BOTTOM=6,_.ScrollView.EVENT_BOUNCE_LEFT=7,_.ScrollView.EVENT_BOUNCE_RIGHT=8,_.ScrollView.EVENT_CONTAINER_MOVED=9,_.ScrollView.EVENT_AUTOSCROLL_ENDED=10,_.ScrollView.MOVEDIR_TOP=0,_.ScrollView.MOVEDIR_BOTTOM=1,_.ScrollView.MOVEDIR_LEFT=2,_.ScrollView.MOVEDIR_RIGHT=3;var d=o.prototype;d.init=function(t){t=t||{},this.type=t.type||u.Coin,this.data={},this._touchEnabled=null,this.items=[],this._innerContainer_width=0,this._innerContainer_height=0,this._innerContainer=c.display.rectangle({x:0,y:0,origin:{x:"center",y:"top"},width:1,height:1}),this._innerContainer.mustShow=!0,c.addChild(this._innerContainer,!1),this._viewSize={width:640,height:860},this._lastUpdateScrollTime=0,this.setContentSize(this._viewSize),sharedCanvas.addEventListener("touchstart",this.onTouchBegan.bind(this),!1),sharedCanvas.addEventListener("touchmove",this.onTouchMoved.bind(this),!1),sharedCanvas.addEventListener("touchend",this.onTouchEnded.bind(this),!1),sharedCanvas.addEventListener("touchcancel",this.onTouchCanceled.bind(this),!1)},d.update=function(t,i){t=t||[],this.data=t,(i=i||this.type)!=this.type&&(this.type=i,this._autoScrolling=!1,this._innerContainer.pos=cc.p(0,0));for(var e=this.data.length,o=0,r=e;o<r;o++){var a=t[o]||{};a.rank||(a.rank=o+1),this.items[o]?this.items[o].update(a,i):(this.items[o]=new n(320,110*o+55,a,i),this.addChild(this.items[o]))}this.setContentSize(cc.size(640,110*e*2))},d.removeAll=function(){this._innerContainer&&this._innerContainer.removeAllChildren(),this.items=[]},d.addChild=function(t){this._innerContainer&&this._innerContainer.addChild(t.rankItem,!1)},d.setTouchEnabled=function(t){this._touchEnabled!==t&&(this._direction=_.ScrollView.DIR_VERTICAL,this._childFocusCancelOffset=5,this.bounceEnabled=!0,this.inertiaScrollEnabled=!0,this._outOfBoundaryAmount=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollStartPosition=cc.p(0,0),this._autoScrollBrakingStartPosition=cc.p(0,0),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchEnabled=!!t)},d.setViewSize=function(t){this._viewSize=t},d.setContentSize=function(t){var i=this._viewSize;this._leftBoundary=0,this._rightBoundary=i.width,this._topBoundary=0,this._bottomBoundary=i.height;var e=Math.max(this._innerContainer_width,t.width),n=Math.max(this._innerContainer_height,t.height);this._innerContainer.pos=cc.p(0,0),this._innerContainer_width=Math.max(e,i.width),this._innerContainer_height=Math.max(n,i.height);var o=window.innerHeight*window.devicePixelRatio/1136;this._inner_area_y_min=176*o,this._inner_area_y_max=window.innerHeight*window.devicePixelRatio-100*o;var r=window.innerWidth/window.innerHeight/(640/1136);r=r>1?1:r,this._touchScale=1136/(r*window.innerHeight)*2},d.setInnerContainerPosition=function(t){if(t.x!==this._innerContainer.x||t.y!==this._innerContainer.y){if(this._innerContainer.pos={x:t.x,y:t.y},this._outOfBoundaryAmountDirty=!0,this.bounceEnabled)for(var i=_.ScrollView.MOVEDIR_TOP;i<_.ScrollView.MOVEDIR_RIGHT;++i)this._isOutOfBoundary(i)&&this._processScrollEvent(i,!0);this._dispatchEvent(_.ScrollView.EVENT_CONTAINER_MOVED)}},d.getInnerContainerPosition=function(){return cc.p(this._innerContainer.x,this._innerContainer.y)},d._flattenVectorByDirection=function(t){var i=cc.p(0,0);return i.x=this._direction===_.ScrollView.DIR_VERTICAL?0:t.x,i.y=this._direction===_.ScrollView.DIR_HORIZONTAL?0:t.y,i},d.getInnerLeftBoundary=function(){return this._innerContainer.x},d.getInnerTopBoundary=function(){return this._innerContainer.y},d.getInnerRightBoundary=function(){return this.getInnerLeftBoundary()+this._innerContainer_width},d.getInnerBottomBoundary=function(){return this.getInnerTopBoundary()+this._innerContainer_height},d._getHowMuchOutOfBoundary=function(t){if(void 0===t&&(t=cc.p(0,0)),0===t.x&&0===t.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var i=cc.p(0,0),e=this.getInnerLeftBoundary(),n=this.getInnerRightBoundary(),o=this.getInnerTopBoundary(),r=this.getInnerBottomBoundary();return e+t.x>this._leftBoundary?i.x=this._leftBoundary-(e+t.x):n+t.x<this._rightBoundary&&(i.x=this._rightBoundary-(n+t.x)),o+t.y>this._topBoundary?i.y=this._topBoundary-(o+t.y):r+t.y<this._bottomBoundary&&(i.y=this._bottomBoundary-(r+t.y)),0===t.x&&0===t.y&&(this._outOfBoundaryAmount=i,this._outOfBoundaryAmountDirty=!1),i},d._isOutOfBoundary=function(t){var i=this._getHowMuchOutOfBoundary();if(void 0===t)return!this._fltEqualZero(i);switch(t){case _.ScrollView.MOVEDIR_TOP:return i.y>0;case _.ScrollView.MOVEDIR_BOTTOM:return i.y<0;case _.ScrollView.MOVEDIR_LEFT:return i.x<0;case _.ScrollView.MOVEDIR_RIGHT:return i.x>0}return!1},d._moveInnerContainer=function(t,i){var e=this._flattenVectorByDirection(t);this.setInnerContainerPosition(cc.pAdd(this.getInnerContainerPosition(),e));this._getHowMuchOutOfBoundary();this.bounceEnabled&&i&&this._startBounceBackIfNeeded()},d._calculateTouchMoveVelocity=function(){for(var t=0,i=0;i<this._touchMoveTimeDeltas.length;++i)t+=this._touchMoveTimeDeltas[i];if(0==t||t>=this._touchTotalTimeThreshold)return cc.p(0,0);for(var e=cc.p(0,0),i=0;i<this._touchMoveDisplacements.length;++i)e.x+=this._touchMoveDisplacements[i].x,e.y+=this._touchMoveDisplacements[i].y;return cc.pMult(e,1/t)},d.setTouchTotalTimeThreshold=function(t){this._touchTotalTimeThreshold=t},d.getTouchTotalTimeThreshold=function(){return this._touchTotalTimeThreshold},d._startInertiaScroll=function(t){var i=cc.pMult(t,.7);this._startAttenuatingAutoScroll(i,t)},d._startBounceBackIfNeeded=function(){if(!this.bounceEnabled)return!1;var t=this._getHowMuchOutOfBoundary();if(this._fltEqualZero(t))return!1;return this._startAutoScroll(t,1,!0),!0},d._startAutoScrollToDestination=function(t,i,e){this._startAutoScroll(cc.pSub(t,this.getInnerContainerPosition()),i,e)},d._calculateAutoScrollTimeByInitialSpeed=function(t){return Math.sqrt(Math.sqrt(t/5))},d._startAttenuatingAutoScroll=function(t,i){var e=this._calculateAutoScrollTimeByInitialSpeed(cc.pLength(i));this._startAutoScroll(t,e,!0)},d._startAutoScroll=function(t,i,e){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=e,this._autoScrollStartPosition=this.getInnerContainerPosition(),this._autoScrollTotalTime=i,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var o=this._getHowMuchOutOfBoundary();if(!this._fltEqualZero(o)){this._autoScrollCurrentlyOutOfBoundary=!0;var r=this._getHowMuchOutOfBoundary(n);(o.x*r.x>0||o.y*r.y>0)&&(this._autoScrollBraking=!0)}},d.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollAttenuate=!0,this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0},d._isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getInnerContainerPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},d._getAutoScrollStopEpsilon=function(){return 1e-4},d._fltEqualZero=function(t){return Math.abs(t.x)<=1e-4&&Math.abs(t.y)<=1e-4},d._processAutoScrolling=function(t){var i=this._isNecessaryAutoScrollBrake()?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var e=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(e=(e-=1)*e*e*e*e+1);var n=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,e)),o=Math.abs(e-1)<=this._getAutoScrollStopEpsilon();if(this.bounceEnabled)n=cc.pAdd(this._autoScrollBrakingStartPosition,cc.pMult(cc.pSub(n,this._autoScrollBrakingStartPosition),i));else{var r=cc.pSub(n,this.getInnerContainerPosition()),a=this._getHowMuchOutOfBoundary(r);this._fltEqualZero(a)||(n.x+=a.x,n.y+=a.y,o=!0)}o&&(this._autoScrolling=!1,this._dispatchEvent(_.ScrollView.EVENT_AUTOSCROLL_ENDED)),this._moveInnerContainer(cc.pSub(n,this.getInnerContainerPosition()),o)},d._jumpToDestination=function(t,i){void 0===t.x&&(t=cc.p(t,i)),this._autoScrolling=!1,this._moveInnerContainer(cc.pSub(t,this.getInnerContainerPosition()),!0)},d._scrollChildren=function(t){var i=t;if(this.bounceEnabled){e=this._getHowMuchOutOfBoundary();i.x*=0==e.x?1:.5,i.y*=0==e.y?1:.5}if(!this.bounceEnabled){var e=this._getHowMuchOutOfBoundary(i);i.x+=e.x,i.y+=e.y}var n=!1,o=!1,r=!1,a=!1;if(i.y>0)this._innerContainer_height+i.y>=this._bottomBoundary&&(a=!0);else if(i.y<0){0+i.y<=this._topBoundary&&(r=!0)}if(i.x<0)this._innerContainer_width+i.x<=this._rightBoundary&&(o=!0);else if(i.x>0){0+i.x>=this._leftBoundary&&(n=!0)}this._moveInnerContainer(i,!1),0==i.x&&0==i.y||this._processScrollingEvent(),a&&this._processScrollEvent(_.ScrollView.MOVEDIR_BOTTOM,!1),r&&this._processScrollEvent(_.ScrollView.MOVEDIR_TOP,!1),n&&this._processScrollEvent(_.ScrollView.MOVEDIR_LEFT,!1),o&&this._processScrollEvent(_.ScrollView.MOVEDIR_RIGHT,!1)},d._gatherTouchMove=function(t){for(;this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.splice(0,1),this._touchMoveTimeDeltas.splice(0,1);this._touchMoveDisplacements.push(t);var i=(new Date).getTime();this._touchMoveTimeDeltas.push((i-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=i},d.getTouchPosition=function(t){var i=t.changedTouches[0];return i?cc.p(i.clientX*window.devicePixelRatio,i.clientY*this._touchScale):cc.p(0,0)},d._handlePressLogic=function(t){this._bePressed=!0,this._autoScrolling=!1,this._touchMovePreviousTimestamp=(new Date).getTime(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._touchPosition=this.getTouchPosition(t)},d._handleMoveLogic=function(t){var i=this.getTouchPosition(t),e=cc.pSub(i,this._touchPosition);this._touchPosition=i,this._scrollChildren(e),this._gatherTouchMove(e)},d._handleReleaseLogic=function(t){if(this._bePressed=!1,!this._startBounceBackIfNeeded()&&this.inertiaScrollEnabled){var i=this._calculateTouchMoveVelocity();0===i.x&&0===i.y||this._startInertiaScroll(i)}},d.isInRect=function(t){return t>=this._inner_area_y_min&&t<=this._inner_area_y_max},d.onTouchBegan=function(t){this._touchEnabled&&(this._hit=this.isInRect(t.changedTouches[0].clientY*window.devicePixelRatio),this._hit&&this._handlePressLogic(t))},d.onTouchMoved=function(t){this._touchEnabled&&this._hit&&this._handleMoveLogic(t)},d.onTouchEnded=function(t){this._touchEnabled&&this._hit&&this._handleReleaseLogic(t)},d.onTouchCanceled=function(t){this._touchEnabled&&this._handleReleaseLogic(t)},d.calculateDeltaTime=function(){var t=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(t-this._lastUpdateScrollTime)/1e3,this._deltaTime>.2&&(this._deltaTime=1/60),this._lastUpdateScrollTime=t},d.updateAutoScrolling=function(){this.calculateDeltaTime(),this._autoScrolling&&this._processAutoScrolling(this._deltaTime)},d._processScrollEvent=function(t,i){var e=0;switch(t){case _.ScrollView.MOVEDIR_TOP:e=i?_.ScrollView.EVENT_BOUNCE_TOP:_.ScrollView.EVENT_SCROLL_TO_TOP;break;case _.ScrollView.MOVEDIR_BOTTOM:e=i?_.ScrollView.EVENT_BOUNCE_BOTTOM:_.ScrollView.EVENT_SCROLL_TO_BOTTOM;break;case _.ScrollView.MOVEDIR_LEFT:e=i?_.ScrollView.EVENT_BOUNCE_LEFT:_.ScrollView.EVENT_SCROLL_TO_LEFT;break;case _.ScrollView.MOVEDIR_RIGHT:e=i?_.ScrollView.EVENT_BOUNCE_RIGHT:_.ScrollView.EVENT_SCROLL_TO_RIGHT}this._dispatchEvent(e)},d._processScrollingEvent=function(){this._dispatchEvent(_.ScrollView.EVENT_SCROLLING)},d._dispatchEvent=function(t){};var g=null,f=null,S=0,p=null,T=null;wx.onMessage(function(t){var i=t.data,e=i.cmd;if("render"==e){var n=i.rankType;f=n;var r=(new Date).getTime();r-S>1e4&&(S=r,l()),setTimeout(function(){h(n)},0)}else"enableTouch"==e?g&&g.setTouchEnabled(!0):"disableTouch"==e?g&&g.setTouchEnabled(!1):"resize"==e?(console.error("sharedCanvas:",sharedCanvas.width,sharedCanvas.height,i.height),(g=new o({type:u.Gain})).setViewSize(cc.size(640,i.height)),g.setContentSize(cc.size(640,i.height)),c.setLoop(function(){g.updateAutoScrolling()}),c.events.enabled=!1):"update"==e?c.timeline.renderStep():"openid"==e&&(T=i.openid)}); 
 			}); 	require("third/subContext/sub.js");
 	